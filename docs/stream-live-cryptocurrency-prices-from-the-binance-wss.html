<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 1 Stream live cryptocurrency prices from the Binance WSS | Hands-on Elixir &amp; OTP: Cryptocurrency trading bot</title>
  <meta name="description" content="Chapter 1 Stream live cryptocurrency prices from the Binance WSS | Hands-on Elixir &amp; OTP: Cryptocurrency trading bot" />
  <meta name="generator" content="bookdown 0.42 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 1 Stream live cryptocurrency prices from the Binance WSS | Hands-on Elixir &amp; OTP: Cryptocurrency trading bot" />
  <meta property="og:type" content="book" />
  
  
  <meta name="github-repo" content="Cinderella-Man/hands-on-elixir-and-otp-cryptocurrency-trading-bot" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 1 Stream live cryptocurrency prices from the Binance WSS | Hands-on Elixir &amp; OTP: Cryptocurrency trading bot" />
  <meta name="twitter:site" content="@kamilskowron" />
  
  

<meta name="author" content="Kamil Skowron" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="index.html"/>
<link rel="next" href="create-a-naive-trading-strategy---a-single-trader-process-without-supervision.html"/>
<script src="libs/jquery-3.6.1/jquery-3.6.1.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-52FKGBX2B8"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-52FKGBX2B8');
</script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Hands-on Elixir & OTP: Cryptocurrency trading bot</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#want-to-learn-elixir-otp-by-creating-a-real-world-project"><i class="fa fa-check"></i>Want to learn Elixir &amp; OTP by creating a real-world project?</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#limit-of-liabilitydisclaimer-of-warranty"><i class="fa fa-check"></i>Limit of Liability/Disclaimer of Warranty</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#pdf-epub"><i class="fa fa-check"></i>PDF &amp; EPUB</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#preface-1"><i class="fa fa-check"></i>Preface</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#who-this-book-is-for"><i class="fa fa-check"></i>Who this book is for</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#what-this-book-covers"><i class="fa fa-check"></i>What this book covers</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#contributing-errata-and-source-code"><i class="fa fa-check"></i>Contributing, Errata and Source code</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="stream-live-cryptocurrency-prices-from-the-binance-wss.html"><a href="stream-live-cryptocurrency-prices-from-the-binance-wss.html"><i class="fa fa-check"></i><b>1</b> Stream live cryptocurrency prices from the Binance WSS</a>
<ul>
<li class="chapter" data-level="1.1" data-path="stream-live-cryptocurrency-prices-from-the-binance-wss.html"><a href="stream-live-cryptocurrency-prices-from-the-binance-wss.html#objectives"><i class="fa fa-check"></i><b>1.1</b> Objectives</a></li>
<li class="chapter" data-level="1.2" data-path="stream-live-cryptocurrency-prices-from-the-binance-wss.html"><a href="stream-live-cryptocurrency-prices-from-the-binance-wss.html#create-a-new-umbrella-app"><i class="fa fa-check"></i><b>1.2</b> Create a new umbrella app</a></li>
<li class="chapter" data-level="1.3" data-path="stream-live-cryptocurrency-prices-from-the-binance-wss.html"><a href="stream-live-cryptocurrency-prices-from-the-binance-wss.html#create-a-supervised-application-inside-an-umbrella"><i class="fa fa-check"></i><b>1.3</b> Create a supervised application inside an umbrella</a></li>
<li class="chapter" data-level="1.4" data-path="stream-live-cryptocurrency-prices-from-the-binance-wss.html"><a href="stream-live-cryptocurrency-prices-from-the-binance-wss.html#connect-to-binances-websocket-stream-using-the-websockex-module"><i class="fa fa-check"></i><b>1.4</b> Connect to Binance’s WebSocket Stream using the WebSockex module</a></li>
<li class="chapter" data-level="1.5" data-path="stream-live-cryptocurrency-prices-from-the-binance-wss.html"><a href="stream-live-cryptocurrency-prices-from-the-binance-wss.html#decode-incoming-events-using-the-jason-module"><i class="fa fa-check"></i><b>1.5</b> Decode incoming events using the Jason module</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="create-a-naive-trading-strategy---a-single-trader-process-without-supervision.html"><a href="create-a-naive-trading-strategy---a-single-trader-process-without-supervision.html"><i class="fa fa-check"></i><b>2</b> Create a naive trading strategy - a single trader process without supervision</a>
<ul>
<li class="chapter" data-level="2.1" data-path="create-a-naive-trading-strategy---a-single-trader-process-without-supervision.html"><a href="create-a-naive-trading-strategy---a-single-trader-process-without-supervision.html#objectives-1"><i class="fa fa-check"></i><b>2.1</b> Objectives</a></li>
<li class="chapter" data-level="2.2" data-path="create-a-naive-trading-strategy---a-single-trader-process-without-supervision.html"><a href="create-a-naive-trading-strategy---a-single-trader-process-without-supervision.html#initialisation"><i class="fa fa-check"></i><b>2.2</b> Initialisation</a></li>
<li class="chapter" data-level="2.3" data-path="create-a-naive-trading-strategy---a-single-trader-process-without-supervision.html"><a href="create-a-naive-trading-strategy---a-single-trader-process-without-supervision.html#how-trading-strategy-will-work"><i class="fa fa-check"></i><b>2.3</b> How trading strategy will work?</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="create-a-naive-trading-strategy---a-single-trader-process-without-supervision.html"><a href="create-a-naive-trading-strategy---a-single-trader-process-without-supervision.html#implementation-of-the-first-scenario"><i class="fa fa-check"></i><b>2.3.1</b> Implementation of the first scenario</a></li>
<li class="chapter" data-level="2.3.2" data-path="create-a-naive-trading-strategy---a-single-trader-process-without-supervision.html"><a href="create-a-naive-trading-strategy---a-single-trader-process-without-supervision.html#implementation-of-the-second-scenario"><i class="fa fa-check"></i><b>2.3.2</b> Implementation of the second scenario</a></li>
<li class="chapter" data-level="2.3.3" data-path="create-a-naive-trading-strategy---a-single-trader-process-without-supervision.html"><a href="create-a-naive-trading-strategy---a-single-trader-process-without-supervision.html#implementation-of-the-third-scenario"><i class="fa fa-check"></i><b>2.3.3</b> Implementation of the third scenario</a></li>
<li class="chapter" data-level="2.3.4" data-path="create-a-naive-trading-strategy---a-single-trader-process-without-supervision.html"><a href="create-a-naive-trading-strategy---a-single-trader-process-without-supervision.html#implementation-fallback-scenario"><i class="fa fa-check"></i><b>2.3.4</b> Implementation fallback scenario</a></li>
<li class="chapter" data-level="2.3.5" data-path="create-a-naive-trading-strategy---a-single-trader-process-without-supervision.html"><a href="create-a-naive-trading-strategy---a-single-trader-process-without-supervision.html#updating-the-naive-interface"><i class="fa fa-check"></i><b>2.3.5</b> Updating the Naive interface</a></li>
<li class="chapter" data-level="2.3.6" data-path="create-a-naive-trading-strategy---a-single-trader-process-without-supervision.html"><a href="create-a-naive-trading-strategy---a-single-trader-process-without-supervision.html#updating-streamer-app"><i class="fa fa-check"></i><b>2.3.6</b> Updating streamer app</a></li>
<li class="chapter" data-level="2.3.7" data-path="create-a-naive-trading-strategy---a-single-trader-process-without-supervision.html"><a href="create-a-naive-trading-strategy---a-single-trader-process-without-supervision.html#access-details-to-binance"><i class="fa fa-check"></i><b>2.3.7</b> Access details to Binance</a></li>
<li class="chapter" data-level="2.3.8" data-path="create-a-naive-trading-strategy---a-single-trader-process-without-supervision.html"><a href="create-a-naive-trading-strategy---a-single-trader-process-without-supervision.html#test-run"><i class="fa fa-check"></i><b>2.3.8</b> Test run</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="introduce-pubsub-as-a-communication-method.html"><a href="introduce-pubsub-as-a-communication-method.html"><i class="fa fa-check"></i><b>3</b> Introduce PubSub as a communication method</a>
<ul>
<li class="chapter" data-level="3.1" data-path="introduce-pubsub-as-a-communication-method.html"><a href="introduce-pubsub-as-a-communication-method.html#objectives-2"><i class="fa fa-check"></i><b>3.1</b> Objectives</a></li>
<li class="chapter" data-level="3.2" data-path="introduce-pubsub-as-a-communication-method.html"><a href="introduce-pubsub-as-a-communication-method.html#design"><i class="fa fa-check"></i><b>3.2</b> Design</a></li>
<li class="chapter" data-level="3.3" data-path="introduce-pubsub-as-a-communication-method.html"><a href="introduce-pubsub-as-a-communication-method.html#implementation"><i class="fa fa-check"></i><b>3.3</b> Implementation</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="mock-the-binance-api.html"><a href="mock-the-binance-api.html"><i class="fa fa-check"></i><b>4</b> Mock the Binance API</a>
<ul>
<li class="chapter" data-level="4.1" data-path="mock-the-binance-api.html"><a href="mock-the-binance-api.html#objectives-3"><i class="fa fa-check"></i><b>4.1</b> Objectives</a></li>
<li class="chapter" data-level="4.2" data-path="mock-the-binance-api.html"><a href="mock-the-binance-api.html#design-1"><i class="fa fa-check"></i><b>4.2</b> Design</a></li>
<li class="chapter" data-level="4.3" data-path="mock-the-binance-api.html"><a href="mock-the-binance-api.html#create-binancemock-app"><i class="fa fa-check"></i><b>4.3</b> Create “BinanceMock” app</a></li>
<li class="chapter" data-level="4.4" data-path="mock-the-binance-api.html"><a href="mock-the-binance-api.html#implement-getting-exchange-info"><i class="fa fa-check"></i><b>4.4</b> Implement getting exchange info</a></li>
<li class="chapter" data-level="4.5" data-path="mock-the-binance-api.html"><a href="mock-the-binance-api.html#implement-placing-buy-and-sell-orders"><i class="fa fa-check"></i><b>4.5</b> Implement placing buy and sell orders</a></li>
<li class="chapter" data-level="4.6" data-path="mock-the-binance-api.html"><a href="mock-the-binance-api.html#implement-order-retrival"><i class="fa fa-check"></i><b>4.6</b> Implement order retrival</a></li>
<li class="chapter" data-level="4.7" data-path="mock-the-binance-api.html"><a href="mock-the-binance-api.html#implement-callback-for-incoming-trade-events"><i class="fa fa-check"></i><b>4.7</b> Implement callback for incoming trade events</a></li>
<li class="chapter" data-level="4.8" data-path="mock-the-binance-api.html"><a href="mock-the-binance-api.html#upgrade-trader-and-config"><i class="fa fa-check"></i><b>4.8</b> Upgrade trader and config</a></li>
<li class="chapter" data-level="4.9" data-path="mock-the-binance-api.html"><a href="mock-the-binance-api.html#test-the-implementation"><i class="fa fa-check"></i><b>4.9</b> Test the implementation</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="enable-parallel-trading-on-multiple-symbols.html"><a href="enable-parallel-trading-on-multiple-symbols.html"><i class="fa fa-check"></i><b>5</b> Enable parallel trading on multiple symbols</a>
<ul>
<li class="chapter" data-level="5.1" data-path="enable-parallel-trading-on-multiple-symbols.html"><a href="enable-parallel-trading-on-multiple-symbols.html#objectives-4"><i class="fa fa-check"></i><b>5.1</b> Objectives</a></li>
<li class="chapter" data-level="5.2" data-path="enable-parallel-trading-on-multiple-symbols.html"><a href="enable-parallel-trading-on-multiple-symbols.html#introduction---architectural-design"><i class="fa fa-check"></i><b>5.2</b> Introduction - architectural design</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="enable-parallel-trading-on-multiple-symbols.html"><a href="enable-parallel-trading-on-multiple-symbols.html#update-application-supervisor"><i class="fa fa-check"></i><b>5.2.1</b> Update application supervisor</a></li>
<li class="chapter" data-level="5.2.2" data-path="enable-parallel-trading-on-multiple-symbols.html"><a href="enable-parallel-trading-on-multiple-symbols.html#add-interface-method"><i class="fa fa-check"></i><b>5.2.2</b> Add interface method</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="enable-parallel-trading-on-multiple-symbols.html"><a href="enable-parallel-trading-on-multiple-symbols.html#implement-naive.symbolsupervisor"><i class="fa fa-check"></i><b>5.3</b> Implement <code>Naive.SymbolSupervisor</code></a></li>
<li class="chapter" data-level="5.4" data-path="enable-parallel-trading-on-multiple-symbols.html"><a href="enable-parallel-trading-on-multiple-symbols.html#implement-naive.leader"><i class="fa fa-check"></i><b>5.4</b> Implement <code>Naive.Leader</code></a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="enable-parallel-trading-on-multiple-symbols.html"><a href="enable-parallel-trading-on-multiple-symbols.html#updating-the-leader-module"><i class="fa fa-check"></i><b>5.4.1</b> Updating the <code>leader</code> module</a></li>
<li class="chapter" data-level="5.4.2" data-path="enable-parallel-trading-on-multiple-symbols.html"><a href="enable-parallel-trading-on-multiple-symbols.html#updating-the-naive.trader-module"><i class="fa fa-check"></i><b>5.4.2</b> Updating the <code>Naive.Trader</code> module</a></li>
<li class="chapter" data-level="5.4.3" data-path="enable-parallel-trading-on-multiple-symbols.html"><a href="enable-parallel-trading-on-multiple-symbols.html#finalizing-naive.leader-implementation"><i class="fa fa-check"></i><b>5.4.3</b> Finalizing <code>Naive.Leader</code> implementation</a></li>
<li class="chapter" data-level="5.4.4" data-path="enable-parallel-trading-on-multiple-symbols.html"><a href="enable-parallel-trading-on-multiple-symbols.html#iex-testing"><i class="fa fa-check"></i><b>5.4.4</b> IEx testing</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="introduce-a-buy_down_interval-to-make-a-single-trader-more-profitable.html"><a href="introduce-a-buy_down_interval-to-make-a-single-trader-more-profitable.html"><i class="fa fa-check"></i><b>6</b> Introduce a <code>buy_down_interval</code> to make a single trader more profitable</a>
<ul>
<li class="chapter" data-level="6.1" data-path="introduce-a-buy_down_interval-to-make-a-single-trader-more-profitable.html"><a href="introduce-a-buy_down_interval-to-make-a-single-trader-more-profitable.html#objectives-5"><i class="fa fa-check"></i><b>6.1</b> Objectives</a></li>
<li class="chapter" data-level="6.2" data-path="introduce-a-buy_down_interval-to-make-a-single-trader-more-profitable.html"><a href="introduce-a-buy_down_interval-to-make-a-single-trader-more-profitable.html#why-we-need-to-buy-below-the-current-price-feature-overview"><i class="fa fa-check"></i><b>6.2</b> Why we need to buy below the current price? Feature overview</a></li>
<li class="chapter" data-level="6.3" data-path="introduce-a-buy_down_interval-to-make-a-single-trader-more-profitable.html"><a href="introduce-a-buy_down_interval-to-make-a-single-trader-more-profitable.html#naive.trader-implementation"><i class="fa fa-check"></i><b>6.3</b> <code>Naive.Trader</code> implementation</a></li>
<li class="chapter" data-level="6.4" data-path="introduce-a-buy_down_interval-to-make-a-single-trader-more-profitable.html"><a href="introduce-a-buy_down_interval-to-make-a-single-trader-more-profitable.html#naive.leader-implementation"><i class="fa fa-check"></i><b>6.4</b> <code>Naive.Leader</code> implementation</a>
<ul>
<li class="chapter" data-level="6.4.1" data-path="introduce-a-buy_down_interval-to-make-a-single-trader-more-profitable.html"><a href="introduce-a-buy_down_interval-to-make-a-single-trader-more-profitable.html#iex-testing-1"><i class="fa fa-check"></i><b>6.4.1</b> IEx testing</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="introduce-a-trader-budget-and-calculating-the-quantity.html"><a href="introduce-a-trader-budget-and-calculating-the-quantity.html"><i class="fa fa-check"></i><b>7</b> Introduce a trader budget and calculating the quantity</a>
<ul>
<li class="chapter" data-level="7.1" data-path="introduce-a-trader-budget-and-calculating-the-quantity.html"><a href="introduce-a-trader-budget-and-calculating-the-quantity.html#objectives-6"><i class="fa fa-check"></i><b>7.1</b> Objectives</a></li>
<li class="chapter" data-level="7.2" data-path="introduce-a-trader-budget-and-calculating-the-quantity.html"><a href="introduce-a-trader-budget-and-calculating-the-quantity.html#fetch-step_size"><i class="fa fa-check"></i><b>7.2</b> Fetch <code>step_size</code></a></li>
<li class="chapter" data-level="7.3" data-path="introduce-a-trader-budget-and-calculating-the-quantity.html"><a href="introduce-a-trader-budget-and-calculating-the-quantity.html#append-budget-and-step_size-to-the-traders-state-inside-the-leader"><i class="fa fa-check"></i><b>7.3</b> Append <code>budget</code> and <code>step_size</code> to the <code>Trader</code>’s state inside the <code>Leader</code></a></li>
<li class="chapter" data-level="7.4" data-path="introduce-a-trader-budget-and-calculating-the-quantity.html"><a href="introduce-a-trader-budget-and-calculating-the-quantity.html#append-budget-and-step_size-to-the-traders-state"><i class="fa fa-check"></i><b>7.4</b> Append <code>budget</code> and <code>step_size</code> to the <code>Trader</code>’s state</a></li>
<li class="chapter" data-level="7.5" data-path="introduce-a-trader-budget-and-calculating-the-quantity.html"><a href="introduce-a-trader-budget-and-calculating-the-quantity.html#calculate-quantity"><i class="fa fa-check"></i><b>7.5</b> Calculate quantity</a>
<ul>
<li class="chapter" data-level="7.5.1" data-path="introduce-a-trader-budget-and-calculating-the-quantity.html"><a href="introduce-a-trader-budget-and-calculating-the-quantity.html#iex-testing-2"><i class="fa fa-check"></i><b>7.5.1</b> IEx testing</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="add-support-for-multiple-transactions-per-order.html"><a href="add-support-for-multiple-transactions-per-order.html"><i class="fa fa-check"></i><b>8</b> Add support for multiple transactions per order</a>
<ul>
<li class="chapter" data-level="8.1" data-path="add-support-for-multiple-transactions-per-order.html"><a href="add-support-for-multiple-transactions-per-order.html#objectives-7"><i class="fa fa-check"></i><b>8.1</b> Objectives</a></li>
<li class="chapter" data-level="8.2" data-path="add-support-for-multiple-transactions-per-order.html"><a href="add-support-for-multiple-transactions-per-order.html#the-issue-with-the-current-implementation"><i class="fa fa-check"></i><b>8.2</b> The issue with the current implementation</a></li>
<li class="chapter" data-level="8.3" data-path="add-support-for-multiple-transactions-per-order.html"><a href="add-support-for-multiple-transactions-per-order.html#improve-buy-order-filled-callback"><i class="fa fa-check"></i><b>8.3</b> Improve buy order filled callback</a></li>
<li class="chapter" data-level="8.4" data-path="add-support-for-multiple-transactions-per-order.html"><a href="add-support-for-multiple-transactions-per-order.html#implement-buy-order-filled-callback"><i class="fa fa-check"></i><b>8.4</b> Implement buy order “filled” callback</a></li>
<li class="chapter" data-level="8.5" data-path="add-support-for-multiple-transactions-per-order.html"><a href="add-support-for-multiple-transactions-per-order.html#improve-sell-order-callback"><i class="fa fa-check"></i><b>8.5</b> Improve sell order callback</a></li>
<li class="chapter" data-level="8.6" data-path="add-support-for-multiple-transactions-per-order.html"><a href="add-support-for-multiple-transactions-per-order.html#test-the-implementation-1"><i class="fa fa-check"></i><b>8.6</b> Test the implementation</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="run-multiple-traders-in-parallel.html"><a href="run-multiple-traders-in-parallel.html"><i class="fa fa-check"></i><b>9</b> Run multiple traders in parallel</a>
<ul>
<li class="chapter" data-level="9.1" data-path="run-multiple-traders-in-parallel.html"><a href="run-multiple-traders-in-parallel.html#objectives-8"><i class="fa fa-check"></i><b>9.1</b> Objectives</a></li>
<li class="chapter" data-level="9.2" data-path="run-multiple-traders-in-parallel.html"><a href="run-multiple-traders-in-parallel.html#describe-and-design-the-required-functionality"><i class="fa fa-check"></i><b>9.2</b> Describe and design the required functionality</a></li>
<li class="chapter" data-level="9.3" data-path="run-multiple-traders-in-parallel.html"><a href="run-multiple-traders-in-parallel.html#implement-rebuy-inside-naive.trader"><i class="fa fa-check"></i><b>9.3</b> Implement rebuy inside <code>Naive.Trader</code></a></li>
<li class="chapter" data-level="9.4" data-path="run-multiple-traders-in-parallel.html"><a href="run-multiple-traders-in-parallel.html#implement-rebuy-in-the-naive.leader"><i class="fa fa-check"></i><b>9.4</b> Implement rebuy in the <code>Naive.Leader</code></a></li>
<li class="chapter" data-level="9.5" data-path="run-multiple-traders-in-parallel.html"><a href="run-multiple-traders-in-parallel.html#improve-logs-by-assigning-ids-to-traders"><i class="fa fa-check"></i><b>9.5</b> Improve logs by assigning ids to traders</a></li>
<li class="chapter" data-level="9.6" data-path="run-multiple-traders-in-parallel.html"><a href="run-multiple-traders-in-parallel.html#test-the-implementation-2"><i class="fa fa-check"></i><b>9.6</b> Test the implementation</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="fine-tune-trading-strategy-per-symbol.html"><a href="fine-tune-trading-strategy-per-symbol.html"><i class="fa fa-check"></i><b>10</b> Fine-tune trading strategy per symbol</a>
<ul>
<li class="chapter" data-level="10.1" data-path="fine-tune-trading-strategy-per-symbol.html"><a href="fine-tune-trading-strategy-per-symbol.html#objectives-9"><i class="fa fa-check"></i><b>10.1</b> Objectives</a></li>
<li class="chapter" data-level="10.2" data-path="fine-tune-trading-strategy-per-symbol.html"><a href="fine-tune-trading-strategy-per-symbol.html#describe-and-design-the-required-functionality-1"><i class="fa fa-check"></i><b>10.2</b> Describe and design the required functionality</a></li>
<li class="chapter" data-level="10.3" data-path="fine-tune-trading-strategy-per-symbol.html"><a href="fine-tune-trading-strategy-per-symbol.html#add-docker-to-project"><i class="fa fa-check"></i><b>10.3</b> Add docker to project</a></li>
<li class="chapter" data-level="10.4" data-path="fine-tune-trading-strategy-per-symbol.html"><a href="fine-tune-trading-strategy-per-symbol.html#set-up-ecto-inside-the-naive-app"><i class="fa fa-check"></i><b>10.4</b> Set up <code>ecto</code> inside the <code>naive</code> app</a></li>
<li class="chapter" data-level="10.5" data-path="fine-tune-trading-strategy-per-symbol.html"><a href="fine-tune-trading-strategy-per-symbol.html#create-and-migrate-the-db"><i class="fa fa-check"></i><b>10.5</b> Create and migrate the DB</a></li>
<li class="chapter" data-level="10.6" data-path="fine-tune-trading-strategy-per-symbol.html"><a href="fine-tune-trading-strategy-per-symbol.html#seed-symbols-settings"><i class="fa fa-check"></i><b>10.6</b> Seed symbols’ settings</a></li>
<li class="chapter" data-level="10.7" data-path="fine-tune-trading-strategy-per-symbol.html"><a href="fine-tune-trading-strategy-per-symbol.html#update-the-naive.leader-to-fetch-settings"><i class="fa fa-check"></i><b>10.7</b> Update the <code>Naive.Leader</code> to fetch settings</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="supervise-and-autostart-streaming.html"><a href="supervise-and-autostart-streaming.html"><i class="fa fa-check"></i><b>11</b> Supervise and autostart streaming</a>
<ul>
<li class="chapter" data-level="11.1" data-path="supervise-and-autostart-streaming.html"><a href="supervise-and-autostart-streaming.html#objectives-10"><i class="fa fa-check"></i><b>11.1</b> Objectives</a></li>
<li class="chapter" data-level="11.2" data-path="supervise-and-autostart-streaming.html"><a href="supervise-and-autostart-streaming.html#describe-and-design-the-required-functionality-2"><i class="fa fa-check"></i><b>11.2</b> Describe and design the required functionality</a></li>
<li class="chapter" data-level="11.3" data-path="supervise-and-autostart-streaming.html"><a href="supervise-and-autostart-streaming.html#register-the-streamer.binance-processes-with-names"><i class="fa fa-check"></i><b>11.3</b> Register the <code>Streamer.Binance</code> processes with names</a></li>
<li class="chapter" data-level="11.4" data-path="supervise-and-autostart-streaming.html"><a href="supervise-and-autostart-streaming.html#set-up-ecto-inside-the-streamer-app"><i class="fa fa-check"></i><b>11.4</b> Set up <code>ecto</code> inside the <code>streamer</code> app</a></li>
<li class="chapter" data-level="11.5" data-path="supervise-and-autostart-streaming.html"><a href="supervise-and-autostart-streaming.html#create-and-migrate-the-db-1"><i class="fa fa-check"></i><b>11.5</b> Create and migrate the db</a></li>
<li class="chapter" data-level="11.6" data-path="supervise-and-autostart-streaming.html"><a href="supervise-and-autostart-streaming.html#seed-default-settings"><i class="fa fa-check"></i><b>11.6</b> Seed default settings</a></li>
<li class="chapter" data-level="11.7" data-path="supervise-and-autostart-streaming.html"><a href="supervise-and-autostart-streaming.html#implement-the-supervision-tree-and-start-streaming-functionality"><i class="fa fa-check"></i><b>11.7</b> Implement the supervision tree and start streaming functionality</a></li>
<li class="chapter" data-level="11.8" data-path="supervise-and-autostart-streaming.html"><a href="supervise-and-autostart-streaming.html#implement-the-stop-functionality"><i class="fa fa-check"></i><b>11.8</b> Implement the stop functionality</a></li>
<li class="chapter" data-level="11.9" data-path="supervise-and-autostart-streaming.html"><a href="supervise-and-autostart-streaming.html#implement-the-autostart-streaming-functionality"><i class="fa fa-check"></i><b>11.9</b> Implement the autostart streaming functionality</a></li>
<li class="chapter" data-level="11.10" data-path="supervise-and-autostart-streaming.html"><a href="supervise-and-autostart-streaming.html#test-the-implementation-3"><i class="fa fa-check"></i><b>11.10</b> Test the implementation</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="start-stop-shutdown-and-autostart-trading.html"><a href="start-stop-shutdown-and-autostart-trading.html"><i class="fa fa-check"></i><b>12</b> Start, stop, shutdown and autostart trading</a>
<ul>
<li class="chapter" data-level="12.1" data-path="start-stop-shutdown-and-autostart-trading.html"><a href="start-stop-shutdown-and-autostart-trading.html#objectives-11"><i class="fa fa-check"></i><b>12.1</b> Objectives</a></li>
<li class="chapter" data-level="12.2" data-path="start-stop-shutdown-and-autostart-trading.html"><a href="start-stop-shutdown-and-autostart-trading.html#describe-and-design-the-required-functionality-3"><i class="fa fa-check"></i><b>12.2</b> Describe and design the required functionality</a></li>
<li class="chapter" data-level="12.3" data-path="start-stop-shutdown-and-autostart-trading.html"><a href="start-stop-shutdown-and-autostart-trading.html#re-implement-the-start-trading-functionality"><i class="fa fa-check"></i><b>12.3</b> (Re-)Implement the start trading functionality</a></li>
<li class="chapter" data-level="12.4" data-path="start-stop-shutdown-and-autostart-trading.html"><a href="start-stop-shutdown-and-autostart-trading.html#implement-the-stop-trading-functionality"><i class="fa fa-check"></i><b>12.4</b> Implement the stop trading functionality</a></li>
<li class="chapter" data-level="12.5" data-path="start-stop-shutdown-and-autostart-trading.html"><a href="start-stop-shutdown-and-autostart-trading.html#implement-the-autostart-trading-functionality"><i class="fa fa-check"></i><b>12.5</b> Implement the autostart trading functionality</a></li>
<li class="chapter" data-level="12.6" data-path="start-stop-shutdown-and-autostart-trading.html"><a href="start-stop-shutdown-and-autostart-trading.html#implement-the-shutdown-trading-functionality"><i class="fa fa-check"></i><b>12.6</b> Implement the shutdown trading functionality</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="abstract-duplicated-supervision-code.html"><a href="abstract-duplicated-supervision-code.html"><i class="fa fa-check"></i><b>13</b> Abstract duplicated supervision code</a>
<ul>
<li class="chapter" data-level="13.1" data-path="abstract-duplicated-supervision-code.html"><a href="abstract-duplicated-supervision-code.html#objectives-12"><i class="fa fa-check"></i><b>13.1</b> Objectives</a></li>
<li class="chapter" data-level="13.2" data-path="abstract-duplicated-supervision-code.html"><a href="abstract-duplicated-supervision-code.html#overview-of-requirements"><i class="fa fa-check"></i><b>13.2</b> Overview of requirements</a></li>
<li class="chapter" data-level="13.3" data-path="abstract-duplicated-supervision-code.html"><a href="abstract-duplicated-supervision-code.html#pseudo-generalize-core.servicesupervisor-module"><i class="fa fa-check"></i><b>13.3</b> Pseudo generalize Core.ServiceSupervisor module</a></li>
<li class="chapter" data-level="13.4" data-path="abstract-duplicated-supervision-code.html"><a href="abstract-duplicated-supervision-code.html#utilize-pseudo-generalized-code-inside-the-naive-dynamicsymbolsupervisor"><i class="fa fa-check"></i><b>13.4</b> Utilize pseudo generalized code inside the Naive DynamicSymbolSupervisor</a></li>
<li class="chapter" data-level="13.5" data-path="abstract-duplicated-supervision-code.html"><a href="abstract-duplicated-supervision-code.html#implement-a-truly-generic-core.servicesupervisor"><i class="fa fa-check"></i><b>13.5</b> Implement a truly generic <code>Core.ServiceSupervisor</code></a>
<ul>
<li class="chapter" data-level="13.5.1" data-path="abstract-duplicated-supervision-code.html"><a href="abstract-duplicated-supervision-code.html#first-path-starting-with-the-fetch_symbols_to_start0-function"><i class="fa fa-check"></i><b>13.5.1</b> First path starting with the <code>fetch_symbols_to_start/0</code> function</a></li>
<li class="chapter" data-level="13.5.2" data-path="abstract-duplicated-supervision-code.html"><a href="abstract-duplicated-supervision-code.html#second-path-starting-with-the-update_status2"><i class="fa fa-check"></i><b>13.5.2</b> Second path starting with the <code>update_status/2</code></a></li>
<li class="chapter" data-level="13.5.3" data-path="abstract-duplicated-supervision-code.html"><a href="abstract-duplicated-supervision-code.html#third-path-starting-with-the-get_pid1-function"><i class="fa fa-check"></i><b>13.5.3</b> Third path starting with the <code>get_pid/1</code> function</a></li>
</ul></li>
<li class="chapter" data-level="13.6" data-path="abstract-duplicated-supervision-code.html"><a href="abstract-duplicated-supervision-code.html#remove-boilerplate-using-use-macro"><i class="fa fa-check"></i><b>13.6</b> Remove boilerplate using <code>use</code> macro</a></li>
<li class="chapter" data-level="13.7" data-path="abstract-duplicated-supervision-code.html"><a href="abstract-duplicated-supervision-code.html#use-the-core.servicesupervisor-module-inside-the-streamer-application"><i class="fa fa-check"></i><b>13.7</b> Use the <code>Core.ServiceSupervisor</code> module inside the <code>streamer</code> application</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="store-trade-events-and-orders-inside-the-database.html"><a href="store-trade-events-and-orders-inside-the-database.html"><i class="fa fa-check"></i><b>14</b> Store trade events and orders inside the database</a>
<ul>
<li class="chapter" data-level="14.1" data-path="store-trade-events-and-orders-inside-the-database.html"><a href="store-trade-events-and-orders-inside-the-database.html#objectives-13"><i class="fa fa-check"></i><b>14.1</b> Objectives</a></li>
<li class="chapter" data-level="14.2" data-path="store-trade-events-and-orders-inside-the-database.html"><a href="store-trade-events-and-orders-inside-the-database.html#overview-of-requirements-1"><i class="fa fa-check"></i><b>14.2</b> Overview of requirements</a></li>
<li class="chapter" data-level="14.3" data-path="store-trade-events-and-orders-inside-the-database.html"><a href="store-trade-events-and-orders-inside-the-database.html#create-a-new-data_warehouse-application-in-the-umbrella"><i class="fa fa-check"></i><b>14.3</b> Create a new <code>data_warehouse</code> application in the umbrella</a></li>
<li class="chapter" data-level="14.4" data-path="store-trade-events-and-orders-inside-the-database.html"><a href="store-trade-events-and-orders-inside-the-database.html#connect-to-the-database-using-ecto"><i class="fa fa-check"></i><b>14.4</b> Connect to the database using Ecto</a></li>
<li class="chapter" data-level="14.5" data-path="store-trade-events-and-orders-inside-the-database.html"><a href="store-trade-events-and-orders-inside-the-database.html#store-trade-events-data"><i class="fa fa-check"></i><b>14.5</b> Store trade events’ data</a></li>
<li class="chapter" data-level="14.6" data-path="store-trade-events-and-orders-inside-the-database.html"><a href="store-trade-events-and-orders-inside-the-database.html#store-orders-data"><i class="fa fa-check"></i><b>14.6</b> Store orders’ data</a></li>
<li class="chapter" data-level="14.7" data-path="store-trade-events-and-orders-inside-the-database.html"><a href="store-trade-events-and-orders-inside-the-database.html#implement-supervision"><i class="fa fa-check"></i><b>14.7</b> Implement supervision</a>
<ul>
<li class="chapter" data-level="14.7.1" data-path="store-trade-events-and-orders-inside-the-database.html"><a href="store-trade-events-and-orders-inside-the-database.html#create-subscriber_settings-table"><i class="fa fa-check"></i><b>14.7.1</b> Create <code>subscriber_settings</code> table</a></li>
<li class="chapter" data-level="14.7.2" data-path="store-trade-events-and-orders-inside-the-database.html"><a href="store-trade-events-and-orders-inside-the-database.html#redesign-supervision-using-registry"><i class="fa fa-check"></i><b>14.7.2</b> Redesign supervision using Registry</a></li>
<li class="chapter" data-level="14.7.3" data-path="store-trade-events-and-orders-inside-the-database.html"><a href="store-trade-events-and-orders-inside-the-database.html#create-the-datawarehouse.subscriber.dynamicsupervisor-module"><i class="fa fa-check"></i><b>14.7.3</b> Create the <code>DataWarehouse.Subscriber.DynamicSupervisor</code> module</a></li>
<li class="chapter" data-level="14.7.4" data-path="store-trade-events-and-orders-inside-the-database.html"><a href="store-trade-events-and-orders-inside-the-database.html#register-worker-processes-using-via"><i class="fa fa-check"></i><b>14.7.4</b> Register Worker processes using :via</a></li>
<li class="chapter" data-level="14.7.5" data-path="store-trade-events-and-orders-inside-the-database.html"><a href="store-trade-events-and-orders-inside-the-database.html#create-a-new-supervision-level-for-registry-task-and-the-dynamicsupervisor"><i class="fa fa-check"></i><b>14.7.5</b> Create a new supervision level for Registry, Task and the DynamicSupervisor</a></li>
<li class="chapter" data-level="14.7.6" data-path="store-trade-events-and-orders-inside-the-database.html"><a href="store-trade-events-and-orders-inside-the-database.html#link-the-subscribersupervisor-to-the-application"><i class="fa fa-check"></i><b>14.7.6</b> Link the <code>SubscriberSupervisor</code> to the <code>Application</code></a></li>
<li class="chapter" data-level="14.7.7" data-path="store-trade-events-and-orders-inside-the-database.html"><a href="store-trade-events-and-orders-inside-the-database.html#add-interface"><i class="fa fa-check"></i><b>14.7.7</b> Add interface</a></li>
<li class="chapter" data-level="14.7.8" data-path="store-trade-events-and-orders-inside-the-database.html"><a href="store-trade-events-and-orders-inside-the-database.html#test"><i class="fa fa-check"></i><b>14.7.8</b> Test</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="15" data-path="backtest-trading-strategy.html"><a href="backtest-trading-strategy.html"><i class="fa fa-check"></i><b>15</b> Backtest trading strategy</a>
<ul>
<li class="chapter" data-level="15.1" data-path="backtest-trading-strategy.html"><a href="backtest-trading-strategy.html#objectives-14"><i class="fa fa-check"></i><b>15.1</b> Objectives</a></li>
<li class="chapter" data-level="15.2" data-path="backtest-trading-strategy.html"><a href="backtest-trading-strategy.html#overview-of-requirements-2"><i class="fa fa-check"></i><b>15.2</b> Overview of requirements</a></li>
<li class="chapter" data-level="15.3" data-path="backtest-trading-strategy.html"><a href="backtest-trading-strategy.html#implement-the-storing-task"><i class="fa fa-check"></i><b>15.3</b> Implement the storing task</a></li>
<li class="chapter" data-level="15.4" data-path="backtest-trading-strategy.html"><a href="backtest-trading-strategy.html#test-the-backtesting"><i class="fa fa-check"></i><b>15.4</b> Test the backtesting</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="end-to-end-testing.html"><a href="end-to-end-testing.html"><i class="fa fa-check"></i><b>16</b> End-to-end testing</a>
<ul>
<li class="chapter" data-level="16.1" data-path="end-to-end-testing.html"><a href="end-to-end-testing.html#objectives-15"><i class="fa fa-check"></i><b>16.1</b> Objectives</a></li>
<li class="chapter" data-level="16.2" data-path="end-to-end-testing.html"><a href="end-to-end-testing.html#decide-on-the-tested-functionality"><i class="fa fa-check"></i><b>16.2</b> Decide on the tested functionality</a></li>
<li class="chapter" data-level="16.3" data-path="end-to-end-testing.html"><a href="end-to-end-testing.html#implement-basic-test"><i class="fa fa-check"></i><b>16.3</b> Implement basic test</a></li>
<li class="chapter" data-level="16.4" data-path="end-to-end-testing.html"><a href="end-to-end-testing.html#introduce-environment-based-config-files"><i class="fa fa-check"></i><b>16.4</b> Introduce environment based config files</a></li>
<li class="chapter" data-level="16.5" data-path="end-to-end-testing.html"><a href="end-to-end-testing.html#add-convenience-aliases"><i class="fa fa-check"></i><b>16.5</b> Add convenience aliases</a></li>
<li class="chapter" data-level="16.6" data-path="end-to-end-testing.html"><a href="end-to-end-testing.html#cache-initial-seed-data-inside-a-file"><i class="fa fa-check"></i><b>16.6</b> Cache initial seed data inside a file</a></li>
<li class="chapter" data-level="16.7" data-path="end-to-end-testing.html"><a href="end-to-end-testing.html#update-seeding-scripts-to-use-the-binancemock"><i class="fa fa-check"></i><b>16.7</b> Update seeding scripts to use the BinanceMock</a></li>
<li class="chapter" data-level="16.8" data-path="end-to-end-testing.html"><a href="end-to-end-testing.html#introduce-the-core-application"><i class="fa fa-check"></i><b>16.8</b> Introduce the Core application</a></li>
</ul></li>
<li class="chapter" data-level="17" data-path="mox-rocks.html"><a href="mox-rocks.html"><i class="fa fa-check"></i><b>17</b> Mox rocks</a>
<ul>
<li class="chapter" data-level="17.1" data-path="mox-rocks.html"><a href="mox-rocks.html#objectives-16"><i class="fa fa-check"></i><b>17.1</b> Objectives</a></li>
<li class="chapter" data-level="17.2" data-path="mox-rocks.html"><a href="mox-rocks.html#introduction-to-mock-based-tests"><i class="fa fa-check"></i><b>17.2</b> Introduction to mock based tests</a></li>
<li class="chapter" data-level="17.3" data-path="mox-rocks.html"><a href="mox-rocks.html#add-the-mox-package"><i class="fa fa-check"></i><b>17.3</b> Add the <code>mox</code> package</a></li>
<li class="chapter" data-level="17.4" data-path="mox-rocks.html"><a href="mox-rocks.html#investigate-the-naive.trader-module"><i class="fa fa-check"></i><b>17.4</b> Investigate the <code>Naive.Trader</code> module</a>
<ul>
<li class="chapter" data-level="17.4.1" data-path="mox-rocks.html"><a href="mox-rocks.html#mock-the-binance-module"><i class="fa fa-check"></i><b>17.4.1</b> Mock the <code>Binance</code> module</a></li>
<li class="chapter" data-level="17.4.2" data-path="mox-rocks.html"><a href="mox-rocks.html#mock-the-naiveleader-module"><i class="fa fa-check"></i><b>17.4.2</b> Mock the <code>NaiveLeader</code> module</a></li>
<li class="chapter" data-level="17.4.3" data-path="mox-rocks.html"><a href="mox-rocks.html#mock-the-phoenix.pubsub-module"><i class="fa fa-check"></i><b>17.4.3</b> Mock the <code>Phoenix.PubSub</code> module</a></li>
<li class="chapter" data-level="17.4.4" data-path="mox-rocks.html"><a href="mox-rocks.html#mock-the-logger-module"><i class="fa fa-check"></i><b>17.4.4</b> Mock the <code>Logger</code> module</a></li>
</ul></li>
<li class="chapter" data-level="17.5" data-path="mox-rocks.html"><a href="mox-rocks.html#implement-a-test-of-the-naive.trader-module"><i class="fa fa-check"></i><b>17.5</b> Implement a test of the <code>Naive.Trader</code> module</a></li>
<li class="chapter" data-level="17.6" data-path="mox-rocks.html"><a href="mox-rocks.html#define-an-alias-to-run-unit-tests"><i class="fa fa-check"></i><b>17.6</b> Define an alias to run unit tests</a></li>
</ul></li>
<li class="chapter" data-level="18" data-path="functional-elixir.html"><a href="functional-elixir.html"><i class="fa fa-check"></i><b>18</b> Functional Elixir</a>
<ul>
<li class="chapter" data-level="18.1" data-path="functional-elixir.html"><a href="functional-elixir.html#objectives-17"><i class="fa fa-check"></i><b>18.1</b> Objectives</a></li>
<li class="chapter" data-level="18.2" data-path="functional-elixir.html"><a href="functional-elixir.html#the-reasoning-behind-the-functional-approach"><i class="fa fa-check"></i><b>18.2</b> The reasoning behind the functional approach</a></li>
<li class="chapter" data-level="18.3" data-path="functional-elixir.html"><a href="functional-elixir.html#simplifying-by-splitting"><i class="fa fa-check"></i><b>18.3</b> Simplifying by splitting</a></li>
<li class="chapter" data-level="18.4" data-path="functional-elixir.html"><a href="functional-elixir.html#abstracting-the-pure-logic"><i class="fa fa-check"></i><b>18.4</b> Abstracting the “pure” logic</a>
<ul>
<li class="chapter" data-level="18.4.1" data-path="functional-elixir.html"><a href="functional-elixir.html#place-a-buy-order-rules"><i class="fa fa-check"></i><b>18.4.1</b> Place a buy order rules</a></li>
<li class="chapter" data-level="18.4.2" data-path="functional-elixir.html"><a href="functional-elixir.html#race-condition-rules"><i class="fa fa-check"></i><b>18.4.2</b> Race condition rules</a></li>
<li class="chapter" data-level="18.4.3" data-path="functional-elixir.html"><a href="functional-elixir.html#fetch-the-buy-order-rules"><i class="fa fa-check"></i><b>18.4.3</b> Fetch the buy order rules</a></li>
<li class="chapter" data-level="18.4.4" data-path="functional-elixir.html"><a href="functional-elixir.html#place-a-sell-order-rules"><i class="fa fa-check"></i><b>18.4.4</b> Place a sell order rules</a></li>
<li class="chapter" data-level="18.4.5" data-path="functional-elixir.html"><a href="functional-elixir.html#terminate-trader-rules"><i class="fa fa-check"></i><b>18.4.5</b> Terminate trader rules</a></li>
<li class="chapter" data-level="18.4.6" data-path="functional-elixir.html"><a href="functional-elixir.html#fetch-the-sell-order-rules"><i class="fa fa-check"></i><b>18.4.6</b> Fetch the sell order rules</a></li>
<li class="chapter" data-level="18.4.7" data-path="functional-elixir.html"><a href="functional-elixir.html#trigger-rebuy-rules"><i class="fa fa-check"></i><b>18.4.7</b> Trigger rebuy rules</a></li>
<li class="chapter" data-level="18.4.8" data-path="functional-elixir.html"><a href="functional-elixir.html#the-final-clause-rules"><i class="fa fa-check"></i><b>18.4.8</b> The final clause rules</a></li>
<li class="chapter" data-level="18.4.9" data-path="functional-elixir.html"><a href="functional-elixir.html#changes-to-the-naive.trader-module"><i class="fa fa-check"></i><b>18.4.9</b> Changes to the <code>Naive.Trader</code> module</a></li>
<li class="chapter" data-level="18.4.10" data-path="functional-elixir.html"><a href="functional-elixir.html#naive.trader---place-buy-order"><i class="fa fa-check"></i><b>18.4.10</b> <code>Naive.Trader</code> - place buy order</a></li>
<li class="chapter" data-level="18.4.11" data-path="functional-elixir.html"><a href="functional-elixir.html#naive.trader---race-condition-clause"><i class="fa fa-check"></i><b>18.4.11</b> <code>Naive.Trader</code> - Race condition clause</a></li>
<li class="chapter" data-level="18.4.12" data-path="functional-elixir.html"><a href="functional-elixir.html#naive.trader---place-a-sell-order"><i class="fa fa-check"></i><b>18.4.12</b> <code>Naive.Trader</code> - Place a sell order</a></li>
<li class="chapter" data-level="18.4.13" data-path="functional-elixir.html"><a href="functional-elixir.html#naive.trader---fetch-the-buy-order"><i class="fa fa-check"></i><b>18.4.13</b> <code>Naive.Trader</code> - Fetch the buy order</a></li>
<li class="chapter" data-level="18.4.14" data-path="functional-elixir.html"><a href="functional-elixir.html#naive.trader---terminate-the-trader"><i class="fa fa-check"></i><b>18.4.14</b> <code>Naive.Trader</code> - Terminate the trader</a></li>
<li class="chapter" data-level="18.4.15" data-path="functional-elixir.html"><a href="functional-elixir.html#naive.trader---fetch-the-sell-order"><i class="fa fa-check"></i><b>18.4.15</b> <code>Naive.Trader</code> - Fetch the sell order</a></li>
<li class="chapter" data-level="18.4.16" data-path="functional-elixir.html"><a href="functional-elixir.html#naive.trader---triggering-rebuy"><i class="fa fa-check"></i><b>18.4.16</b> <code>Naive.Trader</code> - Triggering rebuy</a></li>
<li class="chapter" data-level="18.4.17" data-path="functional-elixir.html"><a href="functional-elixir.html#naive.trader---the-final-ignore-clause"><i class="fa fa-check"></i><b>18.4.17</b> <code>Naive.Trader</code> - The final ignore clause</a></li>
</ul></li>
<li class="chapter" data-level="18.5" data-path="functional-elixir.html"><a href="functional-elixir.html#dealing-with-dirty-code"><i class="fa fa-check"></i><b>18.5</b> Dealing with dirty code</a></li>
<li class="chapter" data-level="18.6" data-path="functional-elixir.html"><a href="functional-elixir.html#making-dirty-code-testable"><i class="fa fa-check"></i><b>18.6</b> Making dirty code testable</a>
<ul>
<li class="chapter" data-level="18.6.1" data-path="functional-elixir.html"><a href="functional-elixir.html#passing-functions-arguments"><i class="fa fa-check"></i><b>18.6.1</b> Passing functions arguments</a></li>
<li class="chapter" data-level="18.6.2" data-path="functional-elixir.html"><a href="functional-elixir.html#passing-grouped-functions-as-a-context"><i class="fa fa-check"></i><b>18.6.2</b> Passing grouped functions as a context</a></li>
<li class="chapter" data-level="18.6.3" data-path="functional-elixir.html"><a href="functional-elixir.html#passing-grouped-modules-as-a-context"><i class="fa fa-check"></i><b>18.6.3</b> Passing grouped modules as a context</a></li>
<li class="chapter" data-level="18.6.4" data-path="functional-elixir.html"><a href="functional-elixir.html#injecting-modules-to-modules-attributes-based-on-the-configuration"><i class="fa fa-check"></i><b>18.6.4</b> Injecting modules to module’s attributes based on the configuration</a></li>
</ul></li>
<li class="chapter" data-level="18.7" data-path="functional-elixir.html"><a href="functional-elixir.html#the-power-with-in"><i class="fa fa-check"></i><b>18.7</b> The power <code>with</code>-in</a>
<ul>
<li class="chapter" data-level="18.7.1" data-path="functional-elixir.html"><a href="functional-elixir.html#idiomatic-error-handling"><i class="fa fa-check"></i><b>18.7.1</b> Idiomatic error handling</a></li>
</ul></li>
<li class="chapter" data-level="18.8" data-path="functional-elixir.html"><a href="functional-elixir.html#do-or-not-to-do"><i class="fa fa-check"></i><b>18.8</b> Do or not to do</a></li>
<li class="chapter" data-level="18.9" data-path="functional-elixir.html"><a href="functional-elixir.html#final-thoughts"><i class="fa fa-check"></i><b>18.9</b> Final thoughts</a></li>
</ul></li>
<li class="chapter" data-level="19" data-path="idiomatic-otp.html"><a href="idiomatic-otp.html"><i class="fa fa-check"></i><b>19</b> Idiomatic OTP</a>
<ul>
<li class="chapter" data-level="19.1" data-path="idiomatic-otp.html"><a href="idiomatic-otp.html#objectives-18"><i class="fa fa-check"></i><b>19.1</b> Objectives</a></li>
<li class="chapter" data-level="19.2" data-path="idiomatic-otp.html"><a href="idiomatic-otp.html#the-concept"><i class="fa fa-check"></i><b>19.2</b> The concept</a></li>
<li class="chapter" data-level="19.3" data-path="idiomatic-otp.html"><a href="idiomatic-otp.html#initial-implementation"><i class="fa fa-check"></i><b>19.3</b> Initial implementation</a>
<ul>
<li class="chapter" data-level="19.3.1" data-path="idiomatic-otp.html"><a href="idiomatic-otp.html#maybe-functions"><i class="fa fa-check"></i><b>19.3.1</b> Maybe functions</a></li>
<li class="chapter" data-level="19.3.2" data-path="idiomatic-otp.html"><a href="idiomatic-otp.html#testing"><i class="fa fa-check"></i><b>19.3.2</b> Testing</a></li>
<li class="chapter" data-level="19.3.3" data-path="idiomatic-otp.html"><a href="idiomatic-otp.html#supervision"><i class="fa fa-check"></i><b>19.3.3</b> Supervision</a></li>
</ul></li>
<li class="chapter" data-level="19.4" data-path="idiomatic-otp.html"><a href="idiomatic-otp.html#idiomatic-solution"><i class="fa fa-check"></i><b>19.4</b> Idiomatic solution</a></li>
</ul></li>
<li class="chapter" data-level="20" data-path="idiomatic-trading-strategy.html"><a href="idiomatic-trading-strategy.html"><i class="fa fa-check"></i><b>20</b> Idiomatic trading strategy</a>
<ul>
<li class="chapter" data-level="20.1" data-path="idiomatic-trading-strategy.html"><a href="idiomatic-trading-strategy.html#objectives-19"><i class="fa fa-check"></i><b>20.1</b> Objectives</a></li>
<li class="chapter" data-level="20.2" data-path="idiomatic-trading-strategy.html"><a href="idiomatic-trading-strategy.html#following-the-ohlc-footsteps"><i class="fa fa-check"></i><b>20.2</b> Following the OHLC footsteps</a></li>
<li class="chapter" data-level="20.3" data-path="idiomatic-trading-strategy.html"><a href="idiomatic-trading-strategy.html#simplifying-the-naive-supervision-tree"><i class="fa fa-check"></i><b>20.3</b> Simplifying the Naive supervision tree</a>
<ul>
<li class="chapter" data-level="20.3.1" data-path="idiomatic-trading-strategy.html"><a href="idiomatic-trading-strategy.html#the-naive.dynamictradersupervisor-module"><i class="fa fa-check"></i><b>20.3.1</b> The <code>Naive.DynamicTraderSupervisor</code> module</a></li>
<li class="chapter" data-level="20.3.2" data-path="idiomatic-trading-strategy.html"><a href="idiomatic-trading-strategy.html#the-naive-module"><i class="fa fa-check"></i><b>20.3.2</b> The <code>Naive</code> module</a></li>
<li class="chapter" data-level="20.3.3" data-path="idiomatic-trading-strategy.html"><a href="idiomatic-trading-strategy.html#the-naive.supervisor-module"><i class="fa fa-check"></i><b>20.3.3</b> The <code>Naive.Supervisor</code> module</a></li>
<li class="chapter" data-level="20.3.4" data-path="idiomatic-trading-strategy.html"><a href="idiomatic-trading-strategy.html#the-naive.trader-module"><i class="fa fa-check"></i><b>20.3.4</b> The <code>Naive.Trader</code> module</a></li>
</ul></li>
<li class="chapter" data-level="20.4" data-path="idiomatic-trading-strategy.html"><a href="idiomatic-trading-strategy.html#supporting-multiple-positions"><i class="fa fa-check"></i><b>20.4</b> Supporting multiple positions</a>
<ul>
<li class="chapter" data-level="20.4.1" data-path="idiomatic-trading-strategy.html"><a href="idiomatic-trading-strategy.html#initialization"><i class="fa fa-check"></i><b>20.4.1</b> Initialization</a></li>
<li class="chapter" data-level="20.4.2" data-path="idiomatic-trading-strategy.html"><a href="idiomatic-trading-strategy.html#parallelising-the-strategy"><i class="fa fa-check"></i><b>20.4.2</b> Parallelising the strategy</a></li>
</ul></li>
<li class="chapter" data-level="20.5" data-path="idiomatic-trading-strategy.html"><a href="idiomatic-trading-strategy.html#retrofitting-the-shutdown-functionality"><i class="fa fa-check"></i><b>20.5</b> Retrofitting the “shutdown” functionality</a>
<ul>
<li class="chapter" data-level="20.5.1" data-path="idiomatic-trading-strategy.html"><a href="idiomatic-trading-strategy.html#handling-updated-settings"><i class="fa fa-check"></i><b>20.5.1</b> Handling updated settings</a></li>
<li class="chapter" data-level="20.5.2" data-path="idiomatic-trading-strategy.html"><a href="idiomatic-trading-strategy.html#updating-the-naive.strategy-to-honour-the-shutdown-state"><i class="fa fa-check"></i><b>20.5.2</b> Updating the <code>Naive.Strategy</code> to honour the “shutdown” state</a></li>
</ul></li>
<li class="chapter" data-level="20.6" data-path="idiomatic-trading-strategy.html"><a href="idiomatic-trading-strategy.html#updating-the-strategy-to-handle-rebuys"><i class="fa fa-check"></i><b>20.6</b> Updating the Strategy to handle rebuys</a></li>
<li class="chapter" data-level="20.7" data-path="idiomatic-trading-strategy.html"><a href="idiomatic-trading-strategy.html#fetching-active-positions"><i class="fa fa-check"></i><b>20.7</b> Fetching active positions</a></li>
<li class="chapter" data-level="20.8" data-path="idiomatic-trading-strategy.html"><a href="idiomatic-trading-strategy.html#tidying-up"><i class="fa fa-check"></i><b>20.8</b> Tidying up</a></li>
<li class="chapter" data-level="20.9" data-path="idiomatic-trading-strategy.html"><a href="idiomatic-trading-strategy.html#final-thoughts-1"><i class="fa fa-check"></i><b>20.9</b> Final thoughts</a></li>
</ul></li>
<li class="chapter" data-level="21" data-path="layers-of-abstraction.html"><a href="layers-of-abstraction.html"><i class="fa fa-check"></i><b>21</b> Layers of abstraction</a>
<ul>
<li class="chapter" data-level="21.1" data-path="layers-of-abstraction.html"><a href="layers-of-abstraction.html#objectives-20"><i class="fa fa-check"></i><b>21.1</b> Objectives</a></li>
<li class="chapter" data-level="21.2" data-path="layers-of-abstraction.html"><a href="layers-of-abstraction.html#admitting-the-simplification"><i class="fa fa-check"></i><b>21.2</b> Admitting the simplification</a></li>
<li class="chapter" data-level="21.3" data-path="layers-of-abstraction.html"><a href="layers-of-abstraction.html#abstracting-the-exchange"><i class="fa fa-check"></i><b>21.3</b> Abstracting the exchange</a>
<ul>
<li class="chapter" data-level="21.3.1" data-path="layers-of-abstraction.html"><a href="layers-of-abstraction.html#defining-the-core.exchange-behaviour"><i class="fa fa-check"></i><b>21.3.1</b> Defining the <code>Core.Exchange</code> behaviour</a></li>
<li class="chapter" data-level="21.3.2" data-path="layers-of-abstraction.html"><a href="layers-of-abstraction.html#implementation-of-the-core.exchange.binance-module"><i class="fa fa-check"></i><b>21.3.2</b> Implementation of the <code>Core.Exchange.Binance</code> module</a></li>
<li class="chapter" data-level="21.3.3" data-path="layers-of-abstraction.html"><a href="layers-of-abstraction.html#updating-the-binancemock-module-to-implement-the-core.exchange-behaviour"><i class="fa fa-check"></i><b>21.3.3</b> Updating the <code>BinanceMock</code> module to implement the <code>Core.Exchange</code> behaviour</a></li>
<li class="chapter" data-level="21.3.4" data-path="layers-of-abstraction.html"><a href="layers-of-abstraction.html#updating-the-naive.strategy"><i class="fa fa-check"></i><b>21.3.4</b> Updating the <code>Naive.Strategy</code></a></li>
<li class="chapter" data-level="21.3.5" data-path="layers-of-abstraction.html"><a href="layers-of-abstraction.html#updating-the-seed-scripts"><i class="fa fa-check"></i><b>21.3.5</b> Updating the seed scripts</a></li>
<li class="chapter" data-level="21.3.6" data-path="layers-of-abstraction.html"><a href="layers-of-abstraction.html#manual-testing-after-the-refactoring"><i class="fa fa-check"></i><b>21.3.6</b> Manual testing after the refactoring</a></li>
<li class="chapter" data-level="21.3.7" data-path="layers-of-abstraction.html"><a href="layers-of-abstraction.html#storing-the-data"><i class="fa fa-check"></i><b>21.3.7</b> Storing the data</a></li>
<li class="chapter" data-level="21.3.8" data-path="layers-of-abstraction.html"><a href="layers-of-abstraction.html#the-mox-approach-summary"><i class="fa fa-check"></i><b>21.3.8</b> The <code>Mox</code> approach summary</a></li>
</ul></li>
<li class="chapter" data-level="21.4" data-path="layers-of-abstraction.html"><a href="layers-of-abstraction.html#mimicking-the-reality"><i class="fa fa-check"></i><b>21.4</b> Mimicking the reality</a>
<ul>
<li class="chapter" data-level="21.4.1" data-path="layers-of-abstraction.html"><a href="layers-of-abstraction.html#updating-the-naive.strategy-1"><i class="fa fa-check"></i><b>21.4.1</b> Updating the <code>Naive.Strategy</code></a></li>
<li class="chapter" data-level="21.4.2" data-path="layers-of-abstraction.html"><a href="layers-of-abstraction.html#testing-the-naive.strategy"><i class="fa fa-check"></i><b>21.4.2</b> Testing the <code>Naive.Strategy</code></a></li>
<li class="chapter" data-level="21.4.3" data-path="layers-of-abstraction.html"><a href="layers-of-abstraction.html#logging-elephant-in-the-room"><i class="fa fa-check"></i><b>21.4.3</b> Logging elephant in the room</a></li>
</ul></li>
<li class="chapter" data-level="21.5" data-path="layers-of-abstraction.html"><a href="layers-of-abstraction.html#swapping-back-to-attributes"><i class="fa fa-check"></i><b>21.5</b> Swapping back to attributes</a>
<ul>
<li class="chapter" data-level="21.5.1" data-path="layers-of-abstraction.html"><a href="layers-of-abstraction.html#config-files"><i class="fa fa-check"></i><b>21.5.1</b> Config files</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="22" data-path="win-with-pure-logic.html"><a href="win-with-pure-logic.html"><i class="fa fa-check"></i><b>22</b> 80/20 win with pure logic</a>
<ul>
<li class="chapter" data-level="22.1" data-path="win-with-pure-logic.html"><a href="win-with-pure-logic.html#objectives-21"><i class="fa fa-check"></i><b>22.1</b> Objectives</a></li>
<li class="chapter" data-level="22.2" data-path="win-with-pure-logic.html"><a href="win-with-pure-logic.html#testing-the-pure-logic"><i class="fa fa-check"></i><b>22.2</b> Testing the pure logic</a></li>
</ul></li>
<li class="chapter" data-level="23" data-path="back-to-the-monolith.html"><a href="back-to-the-monolith.html"><i class="fa fa-check"></i><b>23</b> Back to the Monolith</a>
<ul>
<li class="chapter" data-level="23.1" data-path="back-to-the-monolith.html"><a href="back-to-the-monolith.html#objectives-22"><i class="fa fa-check"></i><b>23.1</b> Objectives</a></li>
<li class="chapter" data-level="23.2" data-path="back-to-the-monolith.html"><a href="back-to-the-monolith.html#reverting-the-course-to-the-monolith"><i class="fa fa-check"></i><b>23.2</b> Reverting the course to the monolith</a></li>
<li class="chapter" data-level="23.3" data-path="back-to-the-monolith.html"><a href="back-to-the-monolith.html#creating-a-new-phoenix-app"><i class="fa fa-check"></i><b>23.3</b> Creating a new Phoenix app</a></li>
<li class="chapter" data-level="23.4" data-path="back-to-the-monolith.html"><a href="back-to-the-monolith.html#reintegrating-the-core-app"><i class="fa fa-check"></i><b>23.4</b> Reintegrating the <code>core</code> app</a></li>
<li class="chapter" data-level="23.5" data-path="back-to-the-monolith.html"><a href="back-to-the-monolith.html#reintegrating-the-binance_mock-app"><i class="fa fa-check"></i><b>23.5</b> Reintegrating the <code>binance_mock</code> app</a></li>
<li class="chapter" data-level="23.6" data-path="back-to-the-monolith.html"><a href="back-to-the-monolith.html#reintegrating-the-streamer-app"><i class="fa fa-check"></i><b>23.6</b> Reintegrating the <code>streamer</code> app</a>
<ul>
<li class="chapter" data-level="23.6.1" data-path="back-to-the-monolith.html"><a href="back-to-the-monolith.html#supervisor"><i class="fa fa-check"></i><b>23.6.1</b> Supervisor</a></li>
<li class="chapter" data-level="23.6.2" data-path="back-to-the-monolith.html"><a href="back-to-the-monolith.html#worker"><i class="fa fa-check"></i><b>23.6.2</b> Worker</a></li>
<li class="chapter" data-level="23.6.3" data-path="back-to-the-monolith.html"><a href="back-to-the-monolith.html#dynamicstreamersupervisor"><i class="fa fa-check"></i><b>23.6.3</b> DynamicStreamerSupervisor</a></li>
<li class="chapter" data-level="23.6.4" data-path="back-to-the-monolith.html"><a href="back-to-the-monolith.html#schemasettings.ex-and-schemastreaming_status_enum.ex"><i class="fa fa-check"></i><b>23.6.4</b> schema/settings.ex and schema/streaming_status_enum.ex</a></li>
<li class="chapter" data-level="23.6.5" data-path="back-to-the-monolith.html"><a href="back-to-the-monolith.html#application"><i class="fa fa-check"></i><b>23.6.5</b> application</a></li>
<li class="chapter" data-level="23.6.6" data-path="back-to-the-monolith.html"><a href="back-to-the-monolith.html#db-migrations-and-seeding"><i class="fa fa-check"></i><b>23.6.6</b> DB migrations and seeding</a></li>
<li class="chapter" data-level="23.6.7" data-path="back-to-the-monolith.html"><a href="back-to-the-monolith.html#config"><i class="fa fa-check"></i><b>23.6.7</b> Config</a></li>
<li class="chapter" data-level="23.6.8" data-path="back-to-the-monolith.html"><a href="back-to-the-monolith.html#deps"><i class="fa fa-check"></i><b>23.6.8</b> Deps</a></li>
</ul></li>
<li class="chapter" data-level="23.7" data-path="back-to-the-monolith.html"><a href="back-to-the-monolith.html#reintegrating-the-naive-app"><i class="fa fa-check"></i><b>23.7</b> Reintegrating the <code>naive</code> app</a>
<ul>
<li class="chapter" data-level="23.7.1" data-path="back-to-the-monolith.html"><a href="back-to-the-monolith.html#naive.ex"><i class="fa fa-check"></i><b>23.7.1</b> naive.ex</a></li>
<li class="chapter" data-level="23.7.2" data-path="back-to-the-monolith.html"><a href="back-to-the-monolith.html#strategy.ex---formula.ex"><i class="fa fa-check"></i><b>23.7.2</b> strategy.ex -&gt; formula.ex</a></li>
<li class="chapter" data-level="23.7.3" data-path="back-to-the-monolith.html"><a href="back-to-the-monolith.html#trader.ex"><i class="fa fa-check"></i><b>23.7.3</b> <code>trader.ex</code></a></li>
<li class="chapter" data-level="23.7.4" data-path="back-to-the-monolith.html"><a href="back-to-the-monolith.html#supervisor.ex"><i class="fa fa-check"></i><b>23.7.4</b> <code>supervisor.ex</code></a></li>
<li class="chapter" data-level="23.7.5" data-path="back-to-the-monolith.html"><a href="back-to-the-monolith.html#dynamic_trader_supervisor.ex"><i class="fa fa-check"></i><b>23.7.5</b> <code>dynamic_trader_supervisor.ex</code></a></li>
<li class="chapter" data-level="23.7.6" data-path="back-to-the-monolith.html"><a href="back-to-the-monolith.html#repo-and-schema-files"><i class="fa fa-check"></i><b>23.7.6</b> Repo and <code>schema</code> files</a></li>
<li class="chapter" data-level="23.7.7" data-path="back-to-the-monolith.html"><a href="back-to-the-monolith.html#application.ex"><i class="fa fa-check"></i><b>23.7.7</b> <code>application.ex</code></a></li>
<li class="chapter" data-level="23.7.8" data-path="back-to-the-monolith.html"><a href="back-to-the-monolith.html#migration-and-seeding"><i class="fa fa-check"></i><b>23.7.8</b> Migration and seeding</a></li>
<li class="chapter" data-level="23.7.9" data-path="back-to-the-monolith.html"><a href="back-to-the-monolith.html#configuration"><i class="fa fa-check"></i><b>23.7.9</b> Configuration</a></li>
<li class="chapter" data-level="23.7.10" data-path="back-to-the-monolith.html"><a href="back-to-the-monolith.html#tests"><i class="fa fa-check"></i><b>23.7.10</b> Tests</a></li>
<li class="chapter" data-level="23.7.11" data-path="back-to-the-monolith.html"><a href="back-to-the-monolith.html#dependencies"><i class="fa fa-check"></i><b>23.7.11</b> Dependencies</a></li>
</ul></li>
<li class="chapter" data-level="23.8" data-path="back-to-the-monolith.html"><a href="back-to-the-monolith.html#reintegrating-the-data_warehouse-app"><i class="fa fa-check"></i><b>23.8</b> Reintegrating the <code>data_warehouse</code> app</a>
<ul>
<li class="chapter" data-level="23.8.1" data-path="back-to-the-monolith.html"><a href="back-to-the-monolith.html#exchangeorder.ex"><i class="fa fa-check"></i><b>23.8.1</b> <code>exchange/order.ex</code></a></li>
<li class="chapter" data-level="23.8.2" data-path="back-to-the-monolith.html"><a href="back-to-the-monolith.html#exchangetrade_event.ex"><i class="fa fa-check"></i><b>23.8.2</b> <code>exchange/trade_event.ex</code></a></li>
<li class="chapter" data-level="23.8.3" data-path="back-to-the-monolith.html"><a href="back-to-the-monolith.html#datapublisher.ex"><i class="fa fa-check"></i><b>23.8.3</b> <code>data/publisher.ex</code></a></li>
<li class="chapter" data-level="23.8.4" data-path="back-to-the-monolith.html"><a href="back-to-the-monolith.html#datacollector.ex"><i class="fa fa-check"></i><b>23.8.4</b> <code>data/collector.ex</code></a></li>
<li class="chapter" data-level="23.8.5" data-path="back-to-the-monolith.html"><a href="back-to-the-monolith.html#datacollectorcollector_supervisor.ex"><i class="fa fa-check"></i><b>23.8.5</b> <code>data/collector/collector_supervisor.ex</code></a></li>
<li class="chapter" data-level="23.8.6" data-path="back-to-the-monolith.html"><a href="back-to-the-monolith.html#datacollectordynamic_worker_supervisor.ex"><i class="fa fa-check"></i><b>23.8.6</b> <code>/data/collector/dynamic_worker_supervisor.ex</code></a></li>
<li class="chapter" data-level="23.8.7" data-path="back-to-the-monolith.html"><a href="back-to-the-monolith.html#datacollectorsettings_status_enum.ex"><i class="fa fa-check"></i><b>23.8.7</b> <code>/data/collector/settings_status_enum.ex</code></a></li>
<li class="chapter" data-level="23.8.8" data-path="back-to-the-monolith.html"><a href="back-to-the-monolith.html#datacollectorsettings.ex"><i class="fa fa-check"></i><b>23.8.8</b> <code>/data/collector/settings.ex</code></a></li>
<li class="chapter" data-level="23.8.9" data-path="back-to-the-monolith.html"><a href="back-to-the-monolith.html#datacollectorworker.ex"><i class="fa fa-check"></i><b>23.8.9</b> <code>/data/collector/worker.ex</code></a></li>
<li class="chapter" data-level="23.8.10" data-path="back-to-the-monolith.html"><a href="back-to-the-monolith.html#supervision-tree"><i class="fa fa-check"></i><b>23.8.10</b> Supervision tree</a></li>
<li class="chapter" data-level="23.8.11" data-path="back-to-the-monolith.html"><a href="back-to-the-monolith.html#migrations"><i class="fa fa-check"></i><b>23.8.11</b> Migrations</a></li>
</ul></li>
<li class="chapter" data-level="23.9" data-path="back-to-the-monolith.html"><a href="back-to-the-monolith.html#reintegrating-the-indicator-app"><i class="fa fa-check"></i><b>23.9</b> Reintegrating the <code>indicator</code> app</a>
<ul>
<li class="chapter" data-level="23.9.1" data-path="back-to-the-monolith.html"><a href="back-to-the-monolith.html#dataaggregator.ex"><i class="fa fa-check"></i><b>23.9.1</b> /data/aggregator.ex</a></li>
<li class="chapter" data-level="23.9.2" data-path="back-to-the-monolith.html"><a href="back-to-the-monolith.html#dataaggregatorohlc.ex"><i class="fa fa-check"></i><b>23.9.2</b> /data/aggregator/ohlc.ex</a></li>
<li class="chapter" data-level="23.9.3" data-path="back-to-the-monolith.html"><a href="back-to-the-monolith.html#dataaggregatorohlcworker.ex"><i class="fa fa-check"></i><b>23.9.3</b> /data/aggregator/ohlc/worker.ex</a></li>
<li class="chapter" data-level="23.9.4" data-path="back-to-the-monolith.html"><a href="back-to-the-monolith.html#supervision-tree-1"><i class="fa fa-check"></i><b>23.9.4</b> Supervision tree</a></li>
</ul></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://www.bookdown.org/" target="blank">Created with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Hands-on Elixir &amp; OTP: Cryptocurrency trading bot</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="stream-live-cryptocurrency-prices-from-the-binance-wss" class="section level1 hasAnchor" number="1">
<h1><span class="header-section-number">Chapter 1</span> Stream live cryptocurrency prices from the Binance WSS<a href="stream-live-cryptocurrency-prices-from-the-binance-wss.html#stream-live-cryptocurrency-prices-from-the-binance-wss" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="objectives" class="section level2 hasAnchor" number="1.1">
<h2><span class="header-section-number">1.1</span> Objectives<a href="stream-live-cryptocurrency-prices-from-the-binance-wss.html#objectives" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ul>
<li>create a new umbrella app</li>
<li>create a supervised application inside an umbrella</li>
<li>connect to Binance’s WebSocket Stream using the WebSockex module</li>
<li>define a TradeEvent struct that will hold incoming data</li>
<li>decode incoming events using the Jason module</li>
</ul>
</div>
<div id="create-a-new-umbrella-app" class="section level2 hasAnchor" number="1.2">
<h2><span class="header-section-number">1.2</span> Create a new umbrella app<a href="stream-live-cryptocurrency-prices-from-the-binance-wss.html#create-a-new-umbrella-app" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>As we are starting from scratch, we need to create a new umbrella project:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb1-1"><a href="stream-live-cryptocurrency-prices-from-the-binance-wss.html#cb1-1" tabindex="-1"></a><span class="ex">mix</span> new hedgehog <span class="at">--umbrella</span></span></code></pre></div>
</div>
<div id="create-a-supervised-application-inside-an-umbrella" class="section level2 hasAnchor" number="1.3">
<h2><span class="header-section-number">1.3</span> Create a supervised application inside an umbrella<a href="stream-live-cryptocurrency-prices-from-the-binance-wss.html#create-a-supervised-application-inside-an-umbrella" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>We can now proceed with creating a new supervised application called <code>streamer</code> inside our umbrella:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb2-1"><a href="stream-live-cryptocurrency-prices-from-the-binance-wss.html#cb2-1" tabindex="-1"></a><span class="bu">cd</span> hedgehog/apps</span>
<span id="cb2-2"><a href="stream-live-cryptocurrency-prices-from-the-binance-wss.html#cb2-2" tabindex="-1"></a><span class="ex">mix</span> new streamer <span class="at">--sup</span></span></code></pre></div>
</div>
<div id="connect-to-binances-websocket-stream-using-the-websockex-module" class="section level2 hasAnchor" number="1.4">
<h2><span class="header-section-number">1.4</span> Connect to Binance’s WebSocket Stream using the WebSockex module<a href="stream-live-cryptocurrency-prices-from-the-binance-wss.html#connect-to-binances-websocket-stream-using-the-websockex-module" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>To establish a connection to Binance API’s stream, we will need to use a WebSocket client. The module that we will use is called <a href="https://github.com/Azolo/websockex">WebSockex</a>. Scrolling down to the <code>Installation</code> section inside the module’s readme on Github, we are instructed what dependency we need to add to our project.</p>
<p>We will append <code>:websockex</code> to the <code>deps</code> function inside the <code>mix.exs</code> file of the <code>streamer</code> application:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode elixir"><code class="sourceCode elixir"><span id="cb3-1"><a href="stream-live-cryptocurrency-prices-from-the-binance-wss.html#cb3-1" tabindex="-1"></a>  <span class="co"># /apps/streamer/mix.exs</span></span>
<span id="cb3-2"><a href="stream-live-cryptocurrency-prices-from-the-binance-wss.html#cb3-2" tabindex="-1"></a>  <span class="kw">defp</span> deps <span class="kw">do</span></span>
<span id="cb3-3"><a href="stream-live-cryptocurrency-prices-from-the-binance-wss.html#cb3-3" tabindex="-1"></a>    <span class="ot">[</span></span>
<span id="cb3-4"><a href="stream-live-cryptocurrency-prices-from-the-binance-wss.html#cb3-4" tabindex="-1"></a>      <span class="fu">{</span><span class="va">:websockex</span>, <span class="st">&quot;~&gt; 0.4&quot;</span><span class="fu">}</span></span>
<span id="cb3-5"><a href="stream-live-cryptocurrency-prices-from-the-binance-wss.html#cb3-5" tabindex="-1"></a>    <span class="ot">]</span></span>
<span id="cb3-6"><a href="stream-live-cryptocurrency-prices-from-the-binance-wss.html#cb3-6" tabindex="-1"></a>  <span class="kw">end</span></span></code></pre></div>
<p>As we added a dependency to our project, we need to fetch it using <code>mix deps.get</code>.</p>
<p>We can now progress with creating a module that will be responsible for streaming. We will create a new file called <code>binance.ex</code> inside the <code>apps/streamer/lib/streamer</code> directory.</p>
<p>From the readme of <a href="https://github.com/Azolo/websockex">WebSockex</a> module, we can see that to use it we need to create a module that will implement the <code>WebSockex</code> behavior:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode elixir"><code class="sourceCode elixir"><span id="cb4-1"><a href="stream-live-cryptocurrency-prices-from-the-binance-wss.html#cb4-1" tabindex="-1"></a><span class="co"># WebSockex&#39;s readme</span></span>
<span id="cb4-2"><a href="stream-live-cryptocurrency-prices-from-the-binance-wss.html#cb4-2" tabindex="-1"></a><span class="kw">defmodule</span> <span class="cn">WebSocketExample</span> <span class="kw">do</span></span>
<span id="cb4-3"><a href="stream-live-cryptocurrency-prices-from-the-binance-wss.html#cb4-3" tabindex="-1"></a>  <span class="im">use</span> <span class="cn">WebSockex</span></span>
<span id="cb4-4"><a href="stream-live-cryptocurrency-prices-from-the-binance-wss.html#cb4-4" tabindex="-1"></a></span>
<span id="cb4-5"><a href="stream-live-cryptocurrency-prices-from-the-binance-wss.html#cb4-5" tabindex="-1"></a>  <span class="kw">def</span> start_link<span class="fu">(</span>url, state<span class="fu">)</span> <span class="kw">do</span></span>
<span id="cb4-6"><a href="stream-live-cryptocurrency-prices-from-the-binance-wss.html#cb4-6" tabindex="-1"></a>    <span class="cn">WebSockex</span><span class="op">.</span>start_link<span class="fu">(</span>url, <span class="cn">__MODULE__</span>, state<span class="fu">)</span></span>
<span id="cb4-7"><a href="stream-live-cryptocurrency-prices-from-the-binance-wss.html#cb4-7" tabindex="-1"></a>  <span class="kw">end</span></span>
<span id="cb4-8"><a href="stream-live-cryptocurrency-prices-from-the-binance-wss.html#cb4-8" tabindex="-1"></a></span>
<span id="cb4-9"><a href="stream-live-cryptocurrency-prices-from-the-binance-wss.html#cb4-9" tabindex="-1"></a>  <span class="kw">def</span> handle_frame<span class="fu">({</span>type, msg<span class="fu">}</span>, state<span class="fu">)</span> <span class="kw">do</span></span>
<span id="cb4-10"><a href="stream-live-cryptocurrency-prices-from-the-binance-wss.html#cb4-10" tabindex="-1"></a>    <span class="cn">IO</span><span class="op">.</span>puts <span class="st">&quot;Received Message - Type: </span><span class="ot">#{</span>inspect type<span class="ot">}</span><span class="st"> -- Message: </span><span class="ot">#{</span>inspect msg<span class="ot">}</span><span class="st">&quot;</span></span>
<span id="cb4-11"><a href="stream-live-cryptocurrency-prices-from-the-binance-wss.html#cb4-11" tabindex="-1"></a>    <span class="fu">{</span><span class="va">:ok</span>, state<span class="fu">}</span></span>
<span id="cb4-12"><a href="stream-live-cryptocurrency-prices-from-the-binance-wss.html#cb4-12" tabindex="-1"></a>  <span class="kw">end</span></span>
<span id="cb4-13"><a href="stream-live-cryptocurrency-prices-from-the-binance-wss.html#cb4-13" tabindex="-1"></a></span>
<span id="cb4-14"><a href="stream-live-cryptocurrency-prices-from-the-binance-wss.html#cb4-14" tabindex="-1"></a>  <span class="kw">def</span> handle_cast<span class="fu">({</span><span class="va">:send</span>, <span class="fu">{</span>type, msg<span class="fu">}</span> <span class="op">=</span> frame<span class="fu">}</span>, state<span class="fu">)</span> <span class="kw">do</span></span>
<span id="cb4-15"><a href="stream-live-cryptocurrency-prices-from-the-binance-wss.html#cb4-15" tabindex="-1"></a>    <span class="cn">IO</span><span class="op">.</span>puts <span class="st">&quot;Sending </span><span class="ot">#{</span>type<span class="ot">}</span><span class="st"> frame with payload: </span><span class="ot">#{</span>msg<span class="ot">}</span><span class="st">&quot;</span></span>
<span id="cb4-16"><a href="stream-live-cryptocurrency-prices-from-the-binance-wss.html#cb4-16" tabindex="-1"></a>    <span class="fu">{</span><span class="va">:reply</span>, frame, state<span class="fu">}</span></span>
<span id="cb4-17"><a href="stream-live-cryptocurrency-prices-from-the-binance-wss.html#cb4-17" tabindex="-1"></a>  <span class="kw">end</span></span>
<span id="cb4-18"><a href="stream-live-cryptocurrency-prices-from-the-binance-wss.html#cb4-18" tabindex="-1"></a><span class="kw">end</span></span></code></pre></div>
<p>We will copy the whole code above across to our new <code>binance.ex</code> file.</p>
<div style="page-break-after: always;"></div>
<p>The first step will be to update the module name to match our file name:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode elixir"><code class="sourceCode elixir"><span id="cb5-1"><a href="stream-live-cryptocurrency-prices-from-the-binance-wss.html#cb5-1" tabindex="-1"></a><span class="co"># /apps/streamer/lib/streamer/binance.ex</span></span>
<span id="cb5-2"><a href="stream-live-cryptocurrency-prices-from-the-binance-wss.html#cb5-2" tabindex="-1"></a><span class="kw">defmodule</span> <span class="cn">Streamer</span><span class="op">.</span><span class="cn">Binance</span> <span class="kw">do</span></span></code></pre></div>
<p>In the spirit of keeping things tidy - we will now remove the <code>handle_cast/2</code> function (the last function in our module) as we won’t be sending any messages back to Binance via WebSocket (to place orders etc - Binance provides a REST API which we will use in the next chapter).</p>
<p>Next, let’s look up what URL should we use to connect to Binance’s API. Binance has a separate WSS (Web Socket Streams) documentation at <a href="https://github.com/binance/binance-spot-api-docs/blob/master/web-socket-streams.md">Github</a>.</p>
<p>Scrolling down we can see the <code>General WSS information</code> section where 3 important pieces of information are listed:</p>
<ul>
<li>The base endpoint is: <code>wss://stream.binance.com:9443</code></li>
<li>Raw streams are accessed at <code>/ws/&lt;streamName&gt;</code></li>
<li>All symbols for streams are <em>lowercase</em></li>
</ul>
<p>We can see that the full endpoint for raw streams(we will be using a “raw” stream) will be <code>wss://stream.binance.com:9443/ws/</code> with stream name at the end (together with lowercased symbol).</p>
<p>Note: In the context of Binance API, “raw” means that no aggregation was performed before broadcasting the data on WebSocket.</p>
<p>Let’s introduce a module attribute that will hold the full raw stream endpoint which will be used across the module:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode elixir"><code class="sourceCode elixir"><span id="cb6-1"><a href="stream-live-cryptocurrency-prices-from-the-binance-wss.html#cb6-1" tabindex="-1"></a><span class="co"># /apps/streamer/lib/streamer/binance.ex</span></span>
<span id="cb6-2"><a href="stream-live-cryptocurrency-prices-from-the-binance-wss.html#cb6-2" tabindex="-1"></a><span class="ot">@stream_endpoint</span> <span class="st">&quot;wss://stream.binance.com:9443/ws/&quot;</span></span></code></pre></div>
<p>Now back in <a href="https://github.com/binance/binance-spot-api-docs/blob/master/web-socket-streams.md">Binance’s WSS documentation</a> we need to search for “Trade Streams”. “trade” in the context of this documentation means an exchange of assets(coins/tokens) by two sides (buyer and seller). Our future trading strategy will be interested in the “latest price” which is simply the last trade event’s price.</p>
<p>We can see that docs are pointing to the following stream name:</p>
<pre><code>Stream Name: &lt;symbol&gt;@trade</code></pre>
<p>Together, our full URL looks like: “<a href="wss://stream.binance.com:9443/ws/" class="uri">wss://stream.binance.com:9443/ws/</a><symbol><span class="citation">@trade</span>”.
To give a concrete example: the raw trade events stream URL for symbol XRPUSDT is:
“<a href="wss://stream.binance.com:9443/ws/xrpusdt@trade" class="uri">wss://stream.binance.com:9443/ws/xrpusdt@trade</a>” (remember that symbols need to be lowercased, otherwise no trade events will get streamed - there’s <em>no</em> error).</p>
<div style="page-break-after: always;"></div>
<p>Back to the IDE, we will now modify the <code>start_link/2</code> function to use Binance API’s URL:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode elixir"><code class="sourceCode elixir"><span id="cb8-1"><a href="stream-live-cryptocurrency-prices-from-the-binance-wss.html#cb8-1" tabindex="-1"></a>  <span class="co"># /apps/streamer/lib/streamer/binance.ex</span></span>
<span id="cb8-2"><a href="stream-live-cryptocurrency-prices-from-the-binance-wss.html#cb8-2" tabindex="-1"></a>  <span class="kw">def</span> start_link<span class="fu">(</span>symbol<span class="fu">)</span> <span class="kw">do</span></span>
<span id="cb8-3"><a href="stream-live-cryptocurrency-prices-from-the-binance-wss.html#cb8-3" tabindex="-1"></a>    symbol <span class="op">=</span> <span class="cn">String</span><span class="op">.</span>downcase<span class="fu">(</span>symbol<span class="fu">)</span></span>
<span id="cb8-4"><a href="stream-live-cryptocurrency-prices-from-the-binance-wss.html#cb8-4" tabindex="-1"></a></span>
<span id="cb8-5"><a href="stream-live-cryptocurrency-prices-from-the-binance-wss.html#cb8-5" tabindex="-1"></a>    <span class="cn">WebSockex</span><span class="op">.</span>start_link<span class="fu">(</span></span>
<span id="cb8-6"><a href="stream-live-cryptocurrency-prices-from-the-binance-wss.html#cb8-6" tabindex="-1"></a>      <span class="st">&quot;</span><span class="ot">#{@stream_endpoint}#{</span>symbol<span class="ot">}</span><span class="st">@trade&quot;</span>,</span>
<span id="cb8-7"><a href="stream-live-cryptocurrency-prices-from-the-binance-wss.html#cb8-7" tabindex="-1"></a>      <span class="cn">__MODULE__</span>,</span>
<span id="cb8-8"><a href="stream-live-cryptocurrency-prices-from-the-binance-wss.html#cb8-8" tabindex="-1"></a>      <span class="cn">nil</span></span>
<span id="cb8-9"><a href="stream-live-cryptocurrency-prices-from-the-binance-wss.html#cb8-9" tabindex="-1"></a>    <span class="fu">)</span></span>
<span id="cb8-10"><a href="stream-live-cryptocurrency-prices-from-the-binance-wss.html#cb8-10" tabindex="-1"></a>  <span class="kw">end</span></span></code></pre></div>
<p>Instead of passing an URL, we modified the function to accept a <code>symbol</code>, downcase it and use it together with the module’s <code>@stream_endpoint</code> attribute to build a full URL.</p>
<p>At this moment streaming of trade events already works which we can test using <code>iex</code>:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb9-1"><a href="stream-live-cryptocurrency-prices-from-the-binance-wss.html#cb9-1" tabindex="-1"></a><span class="ex">$</span> iex <span class="at">-S</span> mix</span>
<span id="cb9-2"><a href="stream-live-cryptocurrency-prices-from-the-binance-wss.html#cb9-2" tabindex="-1"></a><span class="ex">...</span></span>
<span id="cb9-3"><a href="stream-live-cryptocurrency-prices-from-the-binance-wss.html#cb9-3" tabindex="-1"></a><span class="ex">iex</span><span class="er">(</span><span class="ex">1</span><span class="kw">)</span><span class="op">&gt;</span> Streamer.Binance.start_link<span class="kw">(</span><span class="st">&quot;xrpusdt&quot;</span><span class="kw">)</span></span>
<span id="cb9-4"><a href="stream-live-cryptocurrency-prices-from-the-binance-wss.html#cb9-4" tabindex="-1"></a><span class="ex">{:ok,</span> <span class="co">#PID&lt;0.335.0&gt;}</span></span>
<span id="cb9-5"><a href="stream-live-cryptocurrency-prices-from-the-binance-wss.html#cb9-5" tabindex="-1"></a><span class="ex">Received</span> Message <span class="at">-</span> Type: :text <span class="at">--</span> Message: <span class="st">&quot;{</span><span class="dt">\&quot;</span><span class="st">e</span><span class="dt">\&quot;</span><span class="st">:</span><span class="dt">\&quot;</span><span class="st">trade</span><span class="dt">\&quot;</span><span class="st">, </span><span class="dt">\&quot;</span><span class="st">E</span><span class="dt">\&quot;</span><span class="st">:1603226394741,</span></span>
<span id="cb9-6"><a href="stream-live-cryptocurrency-prices-from-the-binance-wss.html#cb9-6" tabindex="-1"></a><span class="st">  </span><span class="dt">\&quot;</span><span class="st">s</span><span class="dt">\&quot;</span><span class="st">:</span><span class="dt">\&quot;</span><span class="st">XRPUSDT</span><span class="dt">\&quot;</span><span class="st">,</span><span class="dt">\&quot;</span><span class="st">t</span><span class="dt">\&quot;</span><span class="st">:74608889,</span><span class="dt">\&quot;</span><span class="st">p</span><span class="dt">\&quot;</span><span class="st">:</span><span class="dt">\&quot;</span><span class="st">0.24373000</span><span class="dt">\&quot;</span><span class="st">,</span><span class="dt">\&quot;</span><span class="st">q</span><span class="dt">\&quot;</span><span class="st">:</span><span class="dt">\&quot;</span><span class="st">200.00000000</span><span class="dt">\&quot;</span><span class="st">,</span></span>
<span id="cb9-7"><a href="stream-live-cryptocurrency-prices-from-the-binance-wss.html#cb9-7" tabindex="-1"></a><span class="st">  </span><span class="dt">\&quot;</span><span class="st">b</span><span class="dt">\&quot;</span><span class="st">:948244411,</span><span class="dt">\&quot;</span><span class="st">a</span><span class="dt">\&quot;</span><span class="st">:948244502,</span><span class="dt">\&quot;</span><span class="st">T</span><span class="dt">\&quot;</span><span class="st">:1603226394739,</span><span class="dt">\&quot;</span><span class="st">m</span><span class="dt">\&quot;</span><span class="st">:true,</span><span class="dt">\&quot;</span><span class="st">M</span><span class="dt">\&quot;</span><span class="st">:true}&quot;</span></span></code></pre></div>
<p>We can see the messages logged above because we copied the sample implementation from <a href="https://github.com/Azolo/websockex">WebSockex’s readme</a> where <code>handle_frame/2</code> function uses <code>IO.puts/1</code> to print out all incoming data. The lesson here is that every incoming message from Binance will cause the <code>handle_frame/2</code> callback to be called with the message and the process’ state.</p>
<p>Just for reference, our module should look currently as follows:</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode elixir"><code class="sourceCode elixir"><span id="cb10-1"><a href="stream-live-cryptocurrency-prices-from-the-binance-wss.html#cb10-1" tabindex="-1"></a><span class="co"># /apps/streamer/lib/streamer/binance.ex</span></span>
<span id="cb10-2"><a href="stream-live-cryptocurrency-prices-from-the-binance-wss.html#cb10-2" tabindex="-1"></a><span class="kw">defmodule</span> <span class="cn">Streamer</span><span class="op">.</span><span class="cn">Binance</span> <span class="kw">do</span></span>
<span id="cb10-3"><a href="stream-live-cryptocurrency-prices-from-the-binance-wss.html#cb10-3" tabindex="-1"></a>  <span class="im">use</span> <span class="cn">WebSockex</span></span>
<span id="cb10-4"><a href="stream-live-cryptocurrency-prices-from-the-binance-wss.html#cb10-4" tabindex="-1"></a></span>
<span id="cb10-5"><a href="stream-live-cryptocurrency-prices-from-the-binance-wss.html#cb10-5" tabindex="-1"></a>  <span class="ot">@stream_endpoint</span> <span class="st">&quot;wss://stream.binance.com:9443/ws/&quot;</span></span>
<span id="cb10-6"><a href="stream-live-cryptocurrency-prices-from-the-binance-wss.html#cb10-6" tabindex="-1"></a></span>
<span id="cb10-7"><a href="stream-live-cryptocurrency-prices-from-the-binance-wss.html#cb10-7" tabindex="-1"></a>  <span class="kw">def</span> start_link<span class="fu">(</span>symbol<span class="fu">)</span> <span class="kw">do</span></span>
<span id="cb10-8"><a href="stream-live-cryptocurrency-prices-from-the-binance-wss.html#cb10-8" tabindex="-1"></a>    symbol <span class="op">=</span> <span class="cn">String</span><span class="op">.</span>downcase<span class="fu">(</span>symbol<span class="fu">)</span></span>
<span id="cb10-9"><a href="stream-live-cryptocurrency-prices-from-the-binance-wss.html#cb10-9" tabindex="-1"></a></span>
<span id="cb10-10"><a href="stream-live-cryptocurrency-prices-from-the-binance-wss.html#cb10-10" tabindex="-1"></a>    <span class="cn">WebSockex</span><span class="op">.</span>start_link<span class="fu">(</span></span>
<span id="cb10-11"><a href="stream-live-cryptocurrency-prices-from-the-binance-wss.html#cb10-11" tabindex="-1"></a>      <span class="st">&quot;</span><span class="ot">#{@stream_endpoint}#{</span>symbol<span class="ot">}</span><span class="st">@trade&quot;</span>,</span>
<span id="cb10-12"><a href="stream-live-cryptocurrency-prices-from-the-binance-wss.html#cb10-12" tabindex="-1"></a>      <span class="cn">__MODULE__</span>,</span>
<span id="cb10-13"><a href="stream-live-cryptocurrency-prices-from-the-binance-wss.html#cb10-13" tabindex="-1"></a>      <span class="cn">nil</span></span>
<span id="cb10-14"><a href="stream-live-cryptocurrency-prices-from-the-binance-wss.html#cb10-14" tabindex="-1"></a>    <span class="fu">)</span></span>
<span id="cb10-15"><a href="stream-live-cryptocurrency-prices-from-the-binance-wss.html#cb10-15" tabindex="-1"></a>  <span class="kw">end</span></span>
<span id="cb10-16"><a href="stream-live-cryptocurrency-prices-from-the-binance-wss.html#cb10-16" tabindex="-1"></a></span>
<span id="cb10-17"><a href="stream-live-cryptocurrency-prices-from-the-binance-wss.html#cb10-17" tabindex="-1"></a>  <span class="kw">def</span> handle_frame<span class="fu">({</span>type, msg<span class="fu">}</span>, state<span class="fu">)</span> <span class="kw">do</span></span>
<span id="cb10-18"><a href="stream-live-cryptocurrency-prices-from-the-binance-wss.html#cb10-18" tabindex="-1"></a>    <span class="cn">IO</span><span class="op">.</span>puts <span class="st">&quot;Received Message - Type: </span><span class="ot">#{</span>inspect type<span class="ot">}</span><span class="st"> -- Message: </span><span class="ot">#{</span>inspect msg<span class="ot">}</span><span class="st">&quot;</span></span>
<span id="cb10-19"><a href="stream-live-cryptocurrency-prices-from-the-binance-wss.html#cb10-19" tabindex="-1"></a>    <span class="fu">{</span><span class="va">:ok</span>, state<span class="fu">}</span></span>
<span id="cb10-20"><a href="stream-live-cryptocurrency-prices-from-the-binance-wss.html#cb10-20" tabindex="-1"></a>  <span class="kw">end</span></span>
<span id="cb10-21"><a href="stream-live-cryptocurrency-prices-from-the-binance-wss.html#cb10-21" tabindex="-1"></a><span class="kw">end</span></span></code></pre></div>
</div>
<div id="decode-incoming-events-using-the-jason-module" class="section level2 hasAnchor" number="1.5">
<h2><span class="header-section-number">1.5</span> Decode incoming events using the Jason module<a href="stream-live-cryptocurrency-prices-from-the-binance-wss.html#decode-incoming-events-using-the-jason-module" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Currently, all incoming data from WebSocket is encoded as a JSON. To decode JSON we will use the <a href="https://github.com/michalmuskala/jason">jason</a> module.</p>
<p>Scrolling down to the <code>Installation</code> section inside the module’s readme, we can see that we need to add it to the dependencies and we can start to use it right away.</p>
<p>Let’s open the <code>mix.exs</code> file of the <code>streamer</code> application and append the <code>:jason</code> dependency to the list inside <code>deps</code> function:</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode elixir"><code class="sourceCode elixir"><span id="cb11-1"><a href="stream-live-cryptocurrency-prices-from-the-binance-wss.html#cb11-1" tabindex="-1"></a>  <span class="co"># /apps/streamer/mix.exs</span></span>
<span id="cb11-2"><a href="stream-live-cryptocurrency-prices-from-the-binance-wss.html#cb11-2" tabindex="-1"></a>  <span class="kw">defp</span> deps <span class="kw">do</span></span>
<span id="cb11-3"><a href="stream-live-cryptocurrency-prices-from-the-binance-wss.html#cb11-3" tabindex="-1"></a>    <span class="ot">[</span></span>
<span id="cb11-4"><a href="stream-live-cryptocurrency-prices-from-the-binance-wss.html#cb11-4" tabindex="-1"></a>      <span class="fu">{</span><span class="va">:jason</span>, <span class="st">&quot;~&gt; 1.2&quot;</span><span class="fu">}</span>,</span>
<span id="cb11-5"><a href="stream-live-cryptocurrency-prices-from-the-binance-wss.html#cb11-5" tabindex="-1"></a>      <span class="fu">{</span><span class="va">:websockex</span>, <span class="st">&quot;~&gt; 0.4&quot;</span><span class="fu">}</span></span>
<span id="cb11-6"><a href="stream-live-cryptocurrency-prices-from-the-binance-wss.html#cb11-6" tabindex="-1"></a>    <span class="ot">]</span></span>
<span id="cb11-7"><a href="stream-live-cryptocurrency-prices-from-the-binance-wss.html#cb11-7" tabindex="-1"></a>  <span class="kw">end</span></span></code></pre></div>
<p>As previously, don’t forget to run <code>mix deps.get</code> to fetch the new dependency.</p>
<p>Looking through the documentation of the Jason module we can see <code>encode!/2</code> and <code>decode!/2</code> functions, both of them have exclamation marks which indicate that they will throw an error whenever they will be unable to successfully encode or decode the passed value.</p>
<p>This is less than perfect for our use case as we would like to handle those errors in our own way(technically we could just use try/rescue but as we will find out both <code>encode/2</code> and <code>decode/2</code> are available).</p>
<p>We will go a little bit off-topic but I would highly recommend those sorts of journeys around somebody’s code. Let’s look inside the <a href="https://github.com/michalmuskala/jason/blob/master/lib/jason.ex">Jason</a> module. Scrolling down in search of <code>decode/2</code> (without the exclamation mark) we can see it about line 54:</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode elixir"><code class="sourceCode elixir"><span id="cb12-1"><a href="stream-live-cryptocurrency-prices-from-the-binance-wss.html#cb12-1" tabindex="-1"></a>  <span class="co"># /lib/jason.ex</span></span>
<span id="cb12-2"><a href="stream-live-cryptocurrency-prices-from-the-binance-wss.html#cb12-2" tabindex="-1"></a>  <span class="kw">def</span> decode<span class="fu">(</span>input, opts \\ <span class="ot">[]</span><span class="fu">)</span> <span class="kw">do</span></span>
<span id="cb12-3"><a href="stream-live-cryptocurrency-prices-from-the-binance-wss.html#cb12-3" tabindex="-1"></a>    input <span class="op">=</span> <span class="cn">IO</span><span class="op">.</span>iodata_to_binary<span class="fu">(</span>input<span class="fu">)</span></span>
<span id="cb12-4"><a href="stream-live-cryptocurrency-prices-from-the-binance-wss.html#cb12-4" tabindex="-1"></a>    <span class="cn">Decoder</span><span class="op">.</span>parse<span class="fu">(</span>input, format_decode_opts<span class="fu">(</span>opts<span class="fu">))</span></span>
<span id="cb12-5"><a href="stream-live-cryptocurrency-prices-from-the-binance-wss.html#cb12-5" tabindex="-1"></a>  <span class="kw">end</span></span></code></pre></div>
<div style="page-break-after: always;"></div>
<p>It looks like it uses the <code>parse/2</code> function of a <code>Decoder</code> module, let’s scroll back up and check where it’s coming from. At line 6:</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode elixir"><code class="sourceCode elixir"><span id="cb13-1"><a href="stream-live-cryptocurrency-prices-from-the-binance-wss.html#cb13-1" tabindex="-1"></a><span class="co"># /lib/jason.ex</span></span>
<span id="cb13-2"><a href="stream-live-cryptocurrency-prices-from-the-binance-wss.html#cb13-2" tabindex="-1"></a><span class="im">alias</span> <span class="cn">Jason</span><span class="op">.</span><span class="fu">{</span><span class="cn">Encode</span>, <span class="cn">Decoder</span>, <span class="cn">DecodeError</span>, <span class="cn">EncodeError</span>, <span class="cn">Formatter</span><span class="fu">}</span></span></code></pre></div>
<p>we can see that <code>Decoder</code> is an alias of the <a href="https://github.com/michalmuskala/jason/blob/master/lib/decoder.ex"><code>Jason.Decoder</code></a>. Scrolling down to the <code>Jason.Decoder</code> module we will find a <code>parse/2</code> function about line 43:</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode elixir"><code class="sourceCode elixir"><span id="cb14-1"><a href="stream-live-cryptocurrency-prices-from-the-binance-wss.html#cb14-1" tabindex="-1"></a>  <span class="co"># /lib/decoder.ex</span></span>
<span id="cb14-2"><a href="stream-live-cryptocurrency-prices-from-the-binance-wss.html#cb14-2" tabindex="-1"></a>  <span class="kw">def</span> parse<span class="fu">(</span>data, opts<span class="fu">)</span> <span class="kw">when</span> is_binary<span class="fu">(</span>data<span class="fu">)</span> <span class="kw">do</span></span>
<span id="cb14-3"><a href="stream-live-cryptocurrency-prices-from-the-binance-wss.html#cb14-3" tabindex="-1"></a>    key_decode <span class="op">=</span> key_decode_function<span class="fu">(</span>opts<span class="fu">)</span></span>
<span id="cb14-4"><a href="stream-live-cryptocurrency-prices-from-the-binance-wss.html#cb14-4" tabindex="-1"></a>    string_decode <span class="op">=</span> string_decode_function<span class="fu">(</span>opts<span class="fu">)</span></span>
<span id="cb14-5"><a href="stream-live-cryptocurrency-prices-from-the-binance-wss.html#cb14-5" tabindex="-1"></a>    <span class="cf">try</span> <span class="kw">do</span></span>
<span id="cb14-6"><a href="stream-live-cryptocurrency-prices-from-the-binance-wss.html#cb14-6" tabindex="-1"></a>      value<span class="fu">(</span>data, data, <span class="dv">0</span>, <span class="ot">[@terminate]</span>, key_decode, string_decode<span class="fu">)</span></span>
<span id="cb14-7"><a href="stream-live-cryptocurrency-prices-from-the-binance-wss.html#cb14-7" tabindex="-1"></a>    <span class="cf">catch</span></span>
<span id="cb14-8"><a href="stream-live-cryptocurrency-prices-from-the-binance-wss.html#cb14-8" tabindex="-1"></a>      <span class="fu">{</span><span class="va">:position</span>, position<span class="fu">}</span> <span class="op">-&gt;</span></span>
<span id="cb14-9"><a href="stream-live-cryptocurrency-prices-from-the-binance-wss.html#cb14-9" tabindex="-1"></a>        <span class="fu">{</span><span class="va">:error</span>, %<span class="cn">DecodeError</span><span class="fu">{</span><span class="va">position:</span> position, <span class="va">data:</span> data<span class="fu">}}</span></span>
<span id="cb14-10"><a href="stream-live-cryptocurrency-prices-from-the-binance-wss.html#cb14-10" tabindex="-1"></a>      <span class="fu">{</span><span class="va">:token</span>, token, position<span class="fu">}</span> <span class="op">-&gt;</span></span>
<span id="cb14-11"><a href="stream-live-cryptocurrency-prices-from-the-binance-wss.html#cb14-11" tabindex="-1"></a>        <span class="fu">{</span><span class="va">:error</span>, %<span class="cn">DecodeError</span><span class="fu">{</span><span class="va">token:</span> token, <span class="va">position:</span> position, <span class="va">data:</span> data<span class="fu">}}</span></span>
<span id="cb14-12"><a href="stream-live-cryptocurrency-prices-from-the-binance-wss.html#cb14-12" tabindex="-1"></a>    <span class="cf">else</span></span>
<span id="cb14-13"><a href="stream-live-cryptocurrency-prices-from-the-binance-wss.html#cb14-13" tabindex="-1"></a>      value <span class="op">-&gt;</span></span>
<span id="cb14-14"><a href="stream-live-cryptocurrency-prices-from-the-binance-wss.html#cb14-14" tabindex="-1"></a>        <span class="fu">{</span><span class="va">:ok</span>, value<span class="fu">}</span></span>
<span id="cb14-15"><a href="stream-live-cryptocurrency-prices-from-the-binance-wss.html#cb14-15" tabindex="-1"></a>    <span class="kw">end</span></span>
<span id="cb14-16"><a href="stream-live-cryptocurrency-prices-from-the-binance-wss.html#cb14-16" tabindex="-1"></a>  <span class="kw">end</span></span></code></pre></div>
<p>Based on the result of decoding it will either return <code>{:ok, value}</code> or <code>{:error, %Decode.Error{...}}</code> we can confirm that by digging through documentation of the module on the <a href="https://hexdocs.pm/jason/Jason.html#decode/2">hexdocs</a>.</p>
<p>Once again, the point of this lengthy investigation was to show that Elixir code is readable and easy to understand so don’t be thrown off when documentation is a little bit light, quite opposite, contribute to docs and code as you gain a better understanding of the codebase.</p>
<p>We can now get back to our <code>Streamer.Binance</code> module and modify the <code>handle_frame/2</code> function to decode the incoming JSON message. Based on the result of <code>Jason.decode/2</code> we will either call the <code>process_event/2</code> function or log an error. Here’s the new version of the <code>handle_frame/2</code> function:</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode elixir"><code class="sourceCode elixir"><span id="cb15-1"><a href="stream-live-cryptocurrency-prices-from-the-binance-wss.html#cb15-1" tabindex="-1"></a>  <span class="co"># /apps/streamer/lib/streamer/binance.ex</span></span>
<span id="cb15-2"><a href="stream-live-cryptocurrency-prices-from-the-binance-wss.html#cb15-2" tabindex="-1"></a>  <span class="kw">def</span> handle_frame<span class="fu">({</span>_type, msg<span class="fu">}</span>, state<span class="fu">)</span> <span class="kw">do</span></span>
<span id="cb15-3"><a href="stream-live-cryptocurrency-prices-from-the-binance-wss.html#cb15-3" tabindex="-1"></a>    <span class="kw">case</span> <span class="cn">Jason</span><span class="op">.</span>decode<span class="fu">(</span>msg<span class="fu">)</span> <span class="kw">do</span></span>
<span id="cb15-4"><a href="stream-live-cryptocurrency-prices-from-the-binance-wss.html#cb15-4" tabindex="-1"></a>      <span class="fu">{</span><span class="va">:ok</span>, event<span class="fu">}</span> <span class="op">-&gt;</span> process_event<span class="fu">(</span>event<span class="fu">)</span></span>
<span id="cb15-5"><a href="stream-live-cryptocurrency-prices-from-the-binance-wss.html#cb15-5" tabindex="-1"></a>      <span class="fu">{</span><span class="va">:error</span>, _<span class="fu">}</span> <span class="op">-&gt;</span> <span class="cn">Logger</span><span class="op">.</span>error<span class="fu">(</span><span class="st">&quot;Unable to parse msg: </span><span class="ot">#{</span>msg<span class="ot">}</span><span class="st">&quot;</span><span class="fu">)</span></span>
<span id="cb15-6"><a href="stream-live-cryptocurrency-prices-from-the-binance-wss.html#cb15-6" tabindex="-1"></a>    <span class="kw">end</span></span>
<span id="cb15-7"><a href="stream-live-cryptocurrency-prices-from-the-binance-wss.html#cb15-7" tabindex="-1"></a></span>
<span id="cb15-8"><a href="stream-live-cryptocurrency-prices-from-the-binance-wss.html#cb15-8" tabindex="-1"></a>    <span class="fu">{</span><span class="va">:ok</span>, state<span class="fu">}</span></span>
<span id="cb15-9"><a href="stream-live-cryptocurrency-prices-from-the-binance-wss.html#cb15-9" tabindex="-1"></a>  <span class="kw">end</span></span></code></pre></div>
<p>Please make note that <code>type</code> is now prefixed with an underscore as we aren’t using it at the moment.</p>
<p>The second important thing to note is that we are using <code>Logger</code> so it needs to be <code>require</code>d at the beginning of the module:</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode elixir"><code class="sourceCode elixir"><span id="cb16-1"><a href="stream-live-cryptocurrency-prices-from-the-binance-wss.html#cb16-1" tabindex="-1"></a>  <span class="co"># /apps/streamer/lib/streamer/binance.ex</span></span>
<span id="cb16-2"><a href="stream-live-cryptocurrency-prices-from-the-binance-wss.html#cb16-2" tabindex="-1"></a>  <span class="im">require</span> <span class="cn">Logger</span></span></code></pre></div>
<p>Before implementing the <code>process_event/2</code> function we need to create a structure that will hold the incoming trade event’s data.</p>
<p>Let’s create a new directory called <code>binance</code> inside the <code>apps/streamer/lib/streamer/</code> and a new file called <code>trade_event.ex</code> inside it.</p>
<p>Our new module will hold all the trade event’s information but we will also use readable field names(you will see the incoming data below). We can start by writing a skeleton module code:</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode elixir"><code class="sourceCode elixir"><span id="cb17-1"><a href="stream-live-cryptocurrency-prices-from-the-binance-wss.html#cb17-1" tabindex="-1"></a><span class="co"># /apps/streamer/lib/streamer/binance/trade_event.ex</span></span>
<span id="cb17-2"><a href="stream-live-cryptocurrency-prices-from-the-binance-wss.html#cb17-2" tabindex="-1"></a><span class="kw">defmodule</span> <span class="cn">Streamer</span><span class="op">.</span><span class="cn">Binance</span><span class="op">.</span><span class="cn">TradeEvent</span> <span class="kw">do</span></span>
<span id="cb17-3"><a href="stream-live-cryptocurrency-prices-from-the-binance-wss.html#cb17-3" tabindex="-1"></a>  <span class="kw">defstruct</span> <span class="ot">[]</span></span>
<span id="cb17-4"><a href="stream-live-cryptocurrency-prices-from-the-binance-wss.html#cb17-4" tabindex="-1"></a><span class="kw">end</span></span></code></pre></div>
<p>We can refer to <a href="https://github.com/binance/binance-spot-api-docs/blob/master/web-socket-streams.md#trade-streams">Binance’s docs</a> to get a list of fields:</p>
<pre><code>{
  &quot;e&quot;: &quot;trade&quot;,     // Event type
  &quot;E&quot;: 123456789,   // Event time
  &quot;s&quot;: &quot;BNBUSDT&quot;,   // Symbol
  &quot;t&quot;: 12345,       // Trade ID
  &quot;p&quot;: &quot;0.001&quot;,     // Price
  &quot;q&quot;: &quot;100&quot;,       // Quantity
  &quot;b&quot;: 88,          // Buyer order ID
  &quot;a&quot;: 50,          // Seller order ID
  &quot;T&quot;: 123456785,   // Trade time
  &quot;m&quot;: true,        // Is the buyer the market maker?
  &quot;M&quot;: true         // Ignore
}</code></pre>
<p>Let’s copy them across and convert the comments to update the <code>defstruct</code> inside the<br />
<code>Streamer.Binance.TradeEvent</code> module’s struct to following:</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode elixir"><code class="sourceCode elixir"><span id="cb19-1"><a href="stream-live-cryptocurrency-prices-from-the-binance-wss.html#cb19-1" tabindex="-1"></a>  <span class="co"># /apps/streamer/lib/streamer/binance/trade_event.ex</span></span>
<span id="cb19-2"><a href="stream-live-cryptocurrency-prices-from-the-binance-wss.html#cb19-2" tabindex="-1"></a>  <span class="kw">defstruct</span> <span class="ot">[</span></span>
<span id="cb19-3"><a href="stream-live-cryptocurrency-prices-from-the-binance-wss.html#cb19-3" tabindex="-1"></a>    <span class="va">:event_type</span>,</span>
<span id="cb19-4"><a href="stream-live-cryptocurrency-prices-from-the-binance-wss.html#cb19-4" tabindex="-1"></a>    <span class="va">:event_time</span>,</span>
<span id="cb19-5"><a href="stream-live-cryptocurrency-prices-from-the-binance-wss.html#cb19-5" tabindex="-1"></a>    <span class="va">:symbol</span>,</span>
<span id="cb19-6"><a href="stream-live-cryptocurrency-prices-from-the-binance-wss.html#cb19-6" tabindex="-1"></a>    <span class="va">:trade_id</span>,</span>
<span id="cb19-7"><a href="stream-live-cryptocurrency-prices-from-the-binance-wss.html#cb19-7" tabindex="-1"></a>    <span class="va">:price</span>,</span>
<span id="cb19-8"><a href="stream-live-cryptocurrency-prices-from-the-binance-wss.html#cb19-8" tabindex="-1"></a>    <span class="va">:quantity</span>,</span>
<span id="cb19-9"><a href="stream-live-cryptocurrency-prices-from-the-binance-wss.html#cb19-9" tabindex="-1"></a>    <span class="va">:buyer_order_id</span>,</span>
<span id="cb19-10"><a href="stream-live-cryptocurrency-prices-from-the-binance-wss.html#cb19-10" tabindex="-1"></a>    <span class="va">:seller_order_id</span>,</span>
<span id="cb19-11"><a href="stream-live-cryptocurrency-prices-from-the-binance-wss.html#cb19-11" tabindex="-1"></a>    <span class="va">:trade_time</span>,</span>
<span id="cb19-12"><a href="stream-live-cryptocurrency-prices-from-the-binance-wss.html#cb19-12" tabindex="-1"></a>    <span class="va">:buyer_market_maker</span></span>
<span id="cb19-13"><a href="stream-live-cryptocurrency-prices-from-the-binance-wss.html#cb19-13" tabindex="-1"></a>  <span class="ot">]</span></span></code></pre></div>
<p>That’s all for this struct, we can now get back to implementing the <code>process_event/2</code> function inside the <code>Streamer.Binance</code> module. We will map every field of the response map to the <code>%Streamer.Binance.TradeEvent</code> struct. A useful trick here would be to copy the list of fields once again from the struct and assign the incoming fields one by one.
Inside the header of the function, we will pattern match on event type(a field called “e” in the message) to confirm that indeed we received a trade event). In the end, the <code>process_event/2</code> function should look as follows:</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode elixir"><code class="sourceCode elixir"><span id="cb20-1"><a href="stream-live-cryptocurrency-prices-from-the-binance-wss.html#cb20-1" tabindex="-1"></a>  <span class="co"># /apps/streamer/lib/streamer/binance.ex</span></span>
<span id="cb20-2"><a href="stream-live-cryptocurrency-prices-from-the-binance-wss.html#cb20-2" tabindex="-1"></a>  <span class="kw">defp</span> process_event<span class="fu">(</span>%<span class="fu">{</span><span class="st">&quot;e&quot;</span> <span class="op">=&gt;</span> <span class="st">&quot;trade&quot;</span><span class="fu">}</span> <span class="op">=</span> event<span class="fu">)</span> <span class="kw">do</span></span>
<span id="cb20-3"><a href="stream-live-cryptocurrency-prices-from-the-binance-wss.html#cb20-3" tabindex="-1"></a>    trade_event <span class="op">=</span> %<span class="cn">Streamer</span><span class="op">.</span><span class="cn">Binance</span><span class="op">.</span><span class="cn">TradeEvent</span><span class="fu">{</span></span>
<span id="cb20-4"><a href="stream-live-cryptocurrency-prices-from-the-binance-wss.html#cb20-4" tabindex="-1"></a>      <span class="va">:event_type</span> <span class="op">=&gt;</span> event<span class="ot">[</span><span class="st">&quot;e&quot;</span><span class="ot">]</span>,</span>
<span id="cb20-5"><a href="stream-live-cryptocurrency-prices-from-the-binance-wss.html#cb20-5" tabindex="-1"></a>      <span class="va">:event_time</span> <span class="op">=&gt;</span> event<span class="ot">[</span><span class="st">&quot;E&quot;</span><span class="ot">]</span>,</span>
<span id="cb20-6"><a href="stream-live-cryptocurrency-prices-from-the-binance-wss.html#cb20-6" tabindex="-1"></a>      <span class="va">:symbol</span> <span class="op">=&gt;</span> event<span class="ot">[</span><span class="st">&quot;s&quot;</span><span class="ot">]</span>,</span>
<span id="cb20-7"><a href="stream-live-cryptocurrency-prices-from-the-binance-wss.html#cb20-7" tabindex="-1"></a>      <span class="va">:trade_id</span> <span class="op">=&gt;</span> event<span class="ot">[</span><span class="st">&quot;t&quot;</span><span class="ot">]</span>,</span>
<span id="cb20-8"><a href="stream-live-cryptocurrency-prices-from-the-binance-wss.html#cb20-8" tabindex="-1"></a>      <span class="va">:price</span> <span class="op">=&gt;</span> event<span class="ot">[</span><span class="st">&quot;p&quot;</span><span class="ot">]</span>,</span>
<span id="cb20-9"><a href="stream-live-cryptocurrency-prices-from-the-binance-wss.html#cb20-9" tabindex="-1"></a>      <span class="va">:quantity</span> <span class="op">=&gt;</span> event<span class="ot">[</span><span class="st">&quot;q&quot;</span><span class="ot">]</span>,</span>
<span id="cb20-10"><a href="stream-live-cryptocurrency-prices-from-the-binance-wss.html#cb20-10" tabindex="-1"></a>      <span class="va">:buyer_order_id</span> <span class="op">=&gt;</span> event<span class="ot">[</span><span class="st">&quot;b&quot;</span><span class="ot">]</span>,</span>
<span id="cb20-11"><a href="stream-live-cryptocurrency-prices-from-the-binance-wss.html#cb20-11" tabindex="-1"></a>      <span class="va">:seller_order_id</span> <span class="op">=&gt;</span> event<span class="ot">[</span><span class="st">&quot;a&quot;</span><span class="ot">]</span>,</span>
<span id="cb20-12"><a href="stream-live-cryptocurrency-prices-from-the-binance-wss.html#cb20-12" tabindex="-1"></a>      <span class="va">:trade_time</span> <span class="op">=&gt;</span> event<span class="ot">[</span><span class="st">&quot;T&quot;</span><span class="ot">]</span>,</span>
<span id="cb20-13"><a href="stream-live-cryptocurrency-prices-from-the-binance-wss.html#cb20-13" tabindex="-1"></a>      <span class="va">:buyer_market_maker</span> <span class="op">=&gt;</span> event<span class="ot">[</span><span class="st">&quot;m&quot;</span><span class="ot">]</span></span>
<span id="cb20-14"><a href="stream-live-cryptocurrency-prices-from-the-binance-wss.html#cb20-14" tabindex="-1"></a>    <span class="fu">}</span></span>
<span id="cb20-15"><a href="stream-live-cryptocurrency-prices-from-the-binance-wss.html#cb20-15" tabindex="-1"></a></span>
<span id="cb20-16"><a href="stream-live-cryptocurrency-prices-from-the-binance-wss.html#cb20-16" tabindex="-1"></a>    <span class="cn">Logger</span><span class="op">.</span>debug<span class="fu">(</span></span>
<span id="cb20-17"><a href="stream-live-cryptocurrency-prices-from-the-binance-wss.html#cb20-17" tabindex="-1"></a>      <span class="st">&quot;Trade event received &quot;</span> <span class="op">&lt;&gt;</span></span>
<span id="cb20-18"><a href="stream-live-cryptocurrency-prices-from-the-binance-wss.html#cb20-18" tabindex="-1"></a>        <span class="st">&quot;</span><span class="ot">#{</span>trade_event<span class="op">.</span>symbol<span class="ot">}</span><span class="st">@</span><span class="ot">#{</span>trade_event<span class="op">.</span>price<span class="ot">}</span><span class="st">&quot;</span></span>
<span id="cb20-19"><a href="stream-live-cryptocurrency-prices-from-the-binance-wss.html#cb20-19" tabindex="-1"></a>    <span class="fu">)</span></span>
<span id="cb20-20"><a href="stream-live-cryptocurrency-prices-from-the-binance-wss.html#cb20-20" tabindex="-1"></a>  <span class="kw">end</span></span></code></pre></div>
<p>We added the <code>Logger.debug/2</code> function to be able to see logs of incoming trade events.</p>
<div style="page-break-after: always;"></div>
<p>Lastly, before testing our implementation, let’s add a nice interface to our <code>streamer</code> application that allows starting streaming:</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode elixir"><code class="sourceCode elixir"><span id="cb21-1"><a href="stream-live-cryptocurrency-prices-from-the-binance-wss.html#cb21-1" tabindex="-1"></a><span class="co"># /apps/streamer/lib/streamer.ex</span></span>
<span id="cb21-2"><a href="stream-live-cryptocurrency-prices-from-the-binance-wss.html#cb21-2" tabindex="-1"></a><span class="kw">defmodule</span> <span class="cn">Streamer</span> <span class="kw">do</span></span>
<span id="cb21-3"><a href="stream-live-cryptocurrency-prices-from-the-binance-wss.html#cb21-3" tabindex="-1"></a>  <span class="ot">@moduledoc &quot;&quot;&quot;</span></span>
<span id="cb21-4"><a href="stream-live-cryptocurrency-prices-from-the-binance-wss.html#cb21-4" tabindex="-1"></a><span class="co">  Documentation for </span><span class="in">`Streamer`</span><span class="co">.</span></span>
<span id="cb21-5"><a href="stream-live-cryptocurrency-prices-from-the-binance-wss.html#cb21-5" tabindex="-1"></a><span class="co">  </span><span class="ot">&quot;&quot;&quot;</span></span>
<span id="cb21-6"><a href="stream-live-cryptocurrency-prices-from-the-binance-wss.html#cb21-6" tabindex="-1"></a></span>
<span id="cb21-7"><a href="stream-live-cryptocurrency-prices-from-the-binance-wss.html#cb21-7" tabindex="-1"></a>  <span class="kw">def</span> start_streaming<span class="fu">(</span>symbol<span class="fu">)</span> <span class="kw">do</span></span>
<span id="cb21-8"><a href="stream-live-cryptocurrency-prices-from-the-binance-wss.html#cb21-8" tabindex="-1"></a>    <span class="cn">Streamer</span><span class="op">.</span><span class="cn">Binance</span><span class="op">.</span>start_link<span class="fu">(</span>symbol<span class="fu">)</span></span>
<span id="cb21-9"><a href="stream-live-cryptocurrency-prices-from-the-binance-wss.html#cb21-9" tabindex="-1"></a>  <span class="kw">end</span></span>
<span id="cb21-10"><a href="stream-live-cryptocurrency-prices-from-the-binance-wss.html#cb21-10" tabindex="-1"></a><span class="kw">end</span></span></code></pre></div>
<p>The final version of the <code>Streamer.Binance</code> module should look like <a href="https://github.com/Cinderella-Man/hands-on-elixir-and-otp-cryptocurrency-trading-bot-source-code/blob/chapter_01/apps/streamer/lib/streamer/binance.ex">this</a>.</p>
<p>The last step will be to add the <code>Logger</code> configuration into the main <code>config/config.exs</code> file. We will set the <code>Logger</code> level to <code>:debug</code> for a moment to be able to see incoming trade events:</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode elixir"><code class="sourceCode elixir"><span id="cb22-1"><a href="stream-live-cryptocurrency-prices-from-the-binance-wss.html#cb22-1" tabindex="-1"></a><span class="co"># /config/config.exs</span></span>
<span id="cb22-2"><a href="stream-live-cryptocurrency-prices-from-the-binance-wss.html#cb22-2" tabindex="-1"></a>config <span class="va">:logger</span>,</span>
<span id="cb22-3"><a href="stream-live-cryptocurrency-prices-from-the-binance-wss.html#cb22-3" tabindex="-1"></a>  <span class="va">level:</span> <span class="va">:debug</span></span></code></pre></div>
<p>This finishes the implementation part of this chapter, we can now give our implementation a whirl using <code>iex</code>:</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb23-1"><a href="stream-live-cryptocurrency-prices-from-the-binance-wss.html#cb23-1" tabindex="-1"></a><span class="ex">$</span> iex <span class="at">-S</span> mix</span>
<span id="cb23-2"><a href="stream-live-cryptocurrency-prices-from-the-binance-wss.html#cb23-2" tabindex="-1"></a><span class="ex">...</span></span>
<span id="cb23-3"><a href="stream-live-cryptocurrency-prices-from-the-binance-wss.html#cb23-3" tabindex="-1"></a><span class="ex">iex</span><span class="er">(</span><span class="ex">1</span><span class="kw">)</span><span class="op">&gt;</span> Streamer.start_streaming<span class="kw">(</span><span class="st">&quot;xrpusdt&quot;</span><span class="kw">)</span></span>
<span id="cb23-4"><a href="stream-live-cryptocurrency-prices-from-the-binance-wss.html#cb23-4" tabindex="-1"></a><span class="ex">{:ok,</span> <span class="co">#PID&lt;0.251.0&gt;}</span></span>
<span id="cb23-5"><a href="stream-live-cryptocurrency-prices-from-the-binance-wss.html#cb23-5" tabindex="-1"></a><span class="ex">23:14:32.217</span> <span class="pp">[</span><span class="ss">debug</span><span class="pp">]</span> Trade event received XRPUSDT@0.25604000</span>
<span id="cb23-6"><a href="stream-live-cryptocurrency-prices-from-the-binance-wss.html#cb23-6" tabindex="-1"></a><span class="ex">23:14:33.381</span> <span class="pp">[</span><span class="ss">debug</span><span class="pp">]</span> Trade event received XRPUSDT@0.25604000</span>
<span id="cb23-7"><a href="stream-live-cryptocurrency-prices-from-the-binance-wss.html#cb23-7" tabindex="-1"></a><span class="ex">23:14:35.380</span> <span class="pp">[</span><span class="ss">debug</span><span class="pp">]</span> Trade event received XRPUSDT@0.25605000</span>
<span id="cb23-8"><a href="stream-live-cryptocurrency-prices-from-the-binance-wss.html#cb23-8" tabindex="-1"></a><span class="ex">23:14:36.386</span> <span class="pp">[</span><span class="ss">debug</span><span class="pp">]</span> Trade event received XRPUSDT@0.25606000</span></code></pre></div>
<p>As we can see, the streamer is establishing a WebSocket connection with Binance’s API and its receiving trade events. It decodes them from JSON to <code>%Streamer.Binance.TradeEvent</code> struct and logs a compiled message. Also, our interface hides implementation details from the “user” of our application.</p>
<p>We will now flip the <code>Logger</code> level back to <code>info</code> so the output won’t every incoming trade event:</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode elixir"><code class="sourceCode elixir"><span id="cb24-1"><a href="stream-live-cryptocurrency-prices-from-the-binance-wss.html#cb24-1" tabindex="-1"></a><span class="co"># /config/config.exs</span></span>
<span id="cb24-2"><a href="stream-live-cryptocurrency-prices-from-the-binance-wss.html#cb24-2" tabindex="-1"></a>config <span class="va">:logger</span>,</span>
<span id="cb24-3"><a href="stream-live-cryptocurrency-prices-from-the-binance-wss.html#cb24-3" tabindex="-1"></a>  <span class="va">level:</span> <span class="va">:info</span></span></code></pre></div>
<p>[Note] Please remember to run the <code>mix format</code> to keep things nice and tidy.</p>
<p>The source code for this chapter can be found on <a href="https://github.com/Cinderella-Man/hands-on-elixir-and-otp-cryptocurrency-trading-bot-source-code/tree/chapter_01">GitHub</a></p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="index.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="create-a-naive-trading-strategy---a-single-trader-process-without-supervision.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/Cinderella-Man/hands-on-elixir-and-otp-cryptocurrency-trading-bot/edit/main/01-stream-crypto-prices.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
